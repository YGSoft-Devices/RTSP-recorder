<!DOCTYPE html>
<!-- RTSP Recorder Web Interface - Version 2.33.07 -->
<html lang="{{ current_lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ t('ui.page.title') }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v={{ app_version }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-video"></i>
                    <h1>{{ t('ui.app.name') }}</h1>
                </div>
                <div class="status-badge" id="service-status">
                    <span class="status-dot {{ 'active' if status == 'active' else 'inactive' }}"></span>
                    <span class="status-text">{{ t('ui.status.' ~ status) }}</span>
                </div>
                <div class="language-selector">
                    <label for="lang-select">{{ t('ui.language.label') }}</label>
                    <select id="lang-select" onchange="setLanguage(this.value)">
                        {% for lang in available_langs %}
                        <option value="{{ lang }}" {{ 'selected' if lang == current_lang else '' }}>
                            {{ t_lang(lang, 'i18n.language_name') }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Cards -->
            <section class="dashboard-cards">
                <!-- System Card (1st - most important) -->
                <div class="card info-card card-system">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-server"></i>
                        </div>
                        <h3>{{ t('ui.system.title') }}</h3>
                    </div>
                    <div class="card-content">
                        <div class="system-info">
                            <div class="system-hostname" title="{{ system_info.get('hostname', t('ui.value.na')) }}">
                                <i class="fas fa-tag"></i> {{ system_info.get('hostname', t('ui.value.na')) }}
                            </div>
                            <div class="system-details">
                                <span title="{{ t('ui.system.ip_address') }}"><i class="fas fa-network-wired"></i> {{ system_info.get('ip_addresses', [t('ui.value.na')])[0] }}</span>
                                <span title="{{ t('ui.system.uptime') }}"><i class="fas fa-clock"></i> {{ system_info.get('uptime', t('ui.value.na')) }}</span>
                            </div>
                            <div class="system-metrics">
                                <div class="metric" title="{{ t('ui.system.cpu') }}">
                                    <i class="fas fa-microchip"></i>
                                    <span>{{ system_info.get('cpu_percent', 0) }}%</span>
                                </div>
                                <div class="metric" title="{{ t('ui.system.ram') }}">
                                    <i class="fas fa-memory"></i>
                                    <span>{{ system_info.get('ram_percent', 0) }}%</span>
                                </div>
                                {% if system_info.get('cpu_temp') %}
                                <div class="metric {% if system_info.get('cpu_temp', 0) > 70 %}hot{% elif system_info.get('cpu_temp', 0) > 55 %}warm{% endif %}" title="{{ t('ui.system.temperature') }}">
                                    <i class="fas fa-thermometer-half"></i>
                                    <span>{{ system_info.get('cpu_temp', t('ui.value.na')) }}Â°C</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Storage Card (2nd) -->
                <div class="card info-card card-storage">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <h3>{{ t('ui.storage.title') }}</h3>
                    </div>
                    <div class="card-content">
                        <div class="storage-info">
                            <div class="storage-main">
                                <span class="storage-value">{{ system_info.get('disk_used', t('ui.value.na')) }}</span>
                                <span class="storage-separator">/</span>
                                <span class="storage-total">{{ system_info.get('disk_total', t('ui.value.na')) }}</span>
                            </div>
                            <div class="storage-bar">
                                <div class="storage-bar-fill" style="width: {{ system_info.get('disk_percent_num', 0) }}%"></div>
                            </div>
                            <div class="storage-details">
                                <span><i class="fas fa-folder-open"></i> {{ t('ui.storage.files', count=system_info.get('recording_count', 0)) }}</span>
                                <span><i class="fas fa-film"></i> {{ t('ui.storage.size_mb', size=system_info.get('recording_size_mb', 0)) }}</span>
                                <span class="storage-free"><i class="fas fa-check-circle"></i> {{ t('ui.storage.free', value=system_info.get('disk_avail', t('ui.value.na'))) }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- URL RTSP Card (3rd) -->
                <div class="card info-card card-rtsp">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-link"></i>
                        </div>
                        <h3>{{ t('ui.rtsp.url_title') }}</h3>
                    </div>
                    <div class="card-content">
                        {% if is_provisioned and rtsp_url_hostname %}
                        <div class="url-display-compact">
                            <div class="url-row">
                                <span class="url-badge primary">{{ t('ui.rtsp.primary') }}</span>
                                <code class="url-text" title="{{ rtsp_url_hostname }}">{{ rtsp_url_hostname }}</code>
                                <button class="btn-icon" onclick="copyToClipboard('{{ rtsp_url_hostname }}')" title="{{ t('ui.actions.copy') }}">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                            <div class="url-row">
                                <span class="url-badge secondary">{{ t('ui.rtsp.ip') }}</span>
                                <code class="url-text" title="{{ rtsp_url }}">{{ rtsp_url }}</code>
                                <button class="btn-icon" onclick="copyToClipboard('{{ rtsp_url }}')" title="{{ t('ui.actions.copy') }}">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        {% else %}
                        <div class="url-display-compact">
                            <div class="url-row single">
                                <code class="url-text" title="{{ rtsp_url }}">{{ rtsp_url }}</code>
                                <button class="btn-icon" onclick="copyRtspUrl()" title="{{ t('ui.actions.copy') }}">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Service Control Card (4th) -->
                <div class="card control-card">
                    <h3><i class="fas fa-power-off"></i> {{ t('ui.services.title') }}</h3>
                    <div class="service-selector">
                        <select id="service-select" class="service-select">
                            <option value="rpi-av-rtsp-recorder">{{ t('ui.services.rtsp_streaming') }}</option>
                            <option value="rtsp-watchdog">{{ t('ui.services.watchdog') }}</option>
                            <option value="rpi-cam-onvif">{{ t('ui.services.onvif') }}</option>
                            <option value="rpi-cam-webmanager">{{ t('ui.services.web_manager') }}</option>
                        </select>
                    </div>
                    <div class="control-buttons">
                        <button class="btn btn-success btn-service" onclick="controlServiceAction('start')">
                            <i class="fas fa-play"></i> {{ t('ui.actions.start') }}
                        </button>
                        <button class="btn btn-warning btn-service" onclick="controlServiceAction('restart')">
                            <i class="fas fa-sync"></i> {{ t('ui.actions.restart') }}
                        </button>
                        <button class="btn btn-danger btn-service" onclick="controlServiceAction('stop')">
                            <i class="fas fa-stop"></i> {{ t('ui.actions.stop') }}
                        </button>
                    </div>
                </div>
            </section>

            <!-- Configuration Tabs -->
            <section class="config-section">
                <div class="tabs">
                    <button class="tab-btn active" data-tab="home">
                        <i class="fas fa-home"></i> {{ t('ui.tabs.home') }}
                    </button>
                    <button class="tab-btn" data-tab="rtsp">
                        <i class="fas fa-broadcast-tower"></i> {{ t('ui.tabs.rtsp') }}
                    </button>
                    <button class="tab-btn" data-tab="onvif">
                        <i class="fas fa-eye"></i> {{ t('ui.tabs.onvif') }}
                    </button>
                    <button class="tab-btn" data-tab="video">
                        <i class="fas fa-video"></i> {{ t('ui.tabs.video') }}
                    </button>
                    <button class="tab-btn" data-tab="audio">
                        <i class="fas fa-microphone"></i> {{ t('ui.tabs.audio') }}
                    </button>
                    <button class="tab-btn" data-tab="recording">
                        <i class="fas fa-hdd"></i> {{ t('ui.tabs.storage') }}
                    </button>
                    <button class="tab-btn" data-tab="files">
                        <i class="fas fa-film"></i> {{ t('ui.tabs.recordings') }}
                    </button>
                    <button class="tab-btn" data-tab="network">
                        <i class="fas fa-network-wired"></i> {{ t('ui.tabs.network') }}
                    </button>
                    <button class="tab-btn" data-tab="system">
                        <i class="fas fa-microchip"></i> {{ t('ui.tabs.system') }}
                    </button>
                    <button class="tab-btn" data-tab="meeting">
                        <i class="fas fa-cloud-upload-alt"></i> {{ t('ui.tabs.meeting') }}
                    </button>
                    <button class="tab-btn" data-tab="advanced">
                        <i class="fas fa-cogs"></i> {{ t('ui.tabs.advanced') }}
                    </button>
                    <button class="tab-btn" data-tab="logs">
                        <i class="fas fa-file-alt"></i> {{ t('ui.tabs.logs') }}
                    </button>
                    {% if debug_enabled %}
                    <button class="tab-btn" data-tab="debug">
                        <i class="fas fa-bug"></i> {{ t('ui.tabs.debug') }}
                    </button>
                    {% endif %}
                </div>

                <form id="config-form">
                    <!-- Home Tab (new) -->
                    <div class="tab-content active" id="tab-home">
                        <div class="home-welcome">
                                <div class="welcome-header">
                                    <i class="fas fa-video fa-3x"></i>
                                <h2>{{ t('ui.home.welcome_title') }}</h2>
                                <p class="welcome-subtitle">{{ t('ui.home.welcome_subtitle') }}</p>
                            </div>
                            
                            <div class="home-grid">
                                <!-- Quick Status -->
                                <div class="home-card">
                                    <div class="home-card-header">
                                        <i class="fas fa-heartbeat"></i>
                                        <h3>{{ t('ui.home.system_status_title') }}</h3>
                                    </div>
                                    <div class="home-card-content">
                                        <div class="status-row">
                                            <span>{{ t('ui.home.status.rtsp_service') }}</span>
                                            <span class="status-badge" id="home-rtsp-status">
                                                <span class="status-dot"></span>
                                                <span>{{ t('ui.loading') }}</span>
                                            </span>
                                        </div>
                                        <div class="status-row">
                                            <span>{{ t('ui.home.status.onvif_service') }}</span>
                                            <span class="status-badge" id="home-onvif-status">
                                                <span class="status-dot"></span>
                                                <span>{{ t('ui.loading') }}</span>
                                            </span>
                                        </div>
                                        <div class="status-row">
                                            <span>{{ t('ui.home.status.recording') }}</span>
                                            <span class="status-badge" id="home-recording-status">
                                                <span class="status-dot"></span>
                                                <span>{{ t('ui.loading') }}</span>
                                            </span>
                                        </div>
                                        <div class="status-row">
                                            <span>{{ t('ui.home.status.meeting') }}</span>
                                            <span class="status-badge" id="home-meeting-status">
                                                <span class="status-dot"></span>
                                                <span>{{ t('ui.loading') }}</span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Quick Access -->
                                <div class="home-card">
                                    <div class="home-card-header">
                                        <i class="fas fa-bolt"></i>
                                        <h3>{{ t('ui.home.quick_access_title') }}</h3>
                                    </div>
                                    <div class="home-card-content">
                                        <div class="quick-actions">
                                            <button type="button" class="quick-action-btn" onclick="switchToTab('rtsp')">
                                                <i class="fas fa-broadcast-tower"></i>
                                                <span>{{ t('ui.home.quick.rtsp_config') }}</span>
                                            </button>
                                            <button type="button" class="quick-action-btn" onclick="switchToTab('onvif')">
                                                <i class="fas fa-eye"></i>
                                                <span>{{ t('ui.home.quick.onvif_config') }}</span>
                                            </button>
                                            <button type="button" class="quick-action-btn" onclick="switchToTab('video')">
                                                <i class="fas fa-video"></i>
                                                <span>{{ t('ui.home.quick.video_settings') }}</span>
                                            </button>
                                            <button type="button" class="quick-action-btn" onclick="switchToTab('network')">
                                                <i class="fas fa-network-wired"></i>
                                                <span>{{ t('ui.home.quick.network') }}</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Device Info -->
                                <div class="home-card">
                                    <div class="home-card-header">
                                        <i class="fas fa-info-circle"></i>
                                        <h3>{{ t('ui.home.device_info_title') }}</h3>
                                    </div>
                                    <div class="home-card-content">
                                        <div class="info-row">
                                            <span class="info-label">{{ t('ui.home.device.onvif_name') }}</span>
                                            <span class="info-value" id="home-device-name">{{ t('ui.loading') }}</span>
                                        </div>
                                        <div class="info-row">
                                            <span class="info-label">{{ t('ui.home.device.primary_ip') }}</span>
                                            <span class="info-value" id="home-device-ip">{{ system_info.get('ip', t('ui.value.na')) }}</span>
                                        </div>
                                        <div class="info-row">
                                            <span class="info-label">{{ t('ui.home.device.model') }}</span>
                                            <span class="info-value">{{ system_info.get('model', t('ui.home.device.default_model')) }}</span>
                                        </div>
                                        <div class="info-row">
                                            <span class="info-label">{{ t('ui.home.device.uptime') }}</span>
                                            <span class="info-value" id="home-uptime">{{ system_info.get('uptime', t('ui.value.na')) }}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Cloud Registration Status -->
                                <div class="home-card">
                                    <div class="home-card-header">
                                        <i class="fas fa-cloud"></i>
                                        <h3>{{ t('ui.home.cloud_status_title') }}</h3>
                                    </div>
                                    <div class="home-card-content">
                                        {% if is_provisioned %}
                                        <div class="cloud-status cloud-registered">
                                            <div class="cloud-status-icon">
                                                <i class="fas fa-check-circle"></i>
                                            </div>
                                            <div class="cloud-status-text">
                                                <span class="cloud-status-title">{{ t('ui.home.cloud.registered_title') }}</span>
                                                <span class="cloud-status-subtitle">{{ t('ui.home.cloud.registered_subtitle') }}</span>
                                            </div>
                                        </div>
                                        <div class="cloud-details">
                                            <div class="info-row">
                                                <span class="info-label">{{ t('ui.home.cloud.device_key') }}</span>
                                                <span class="info-value cloud-key" id="home-device-key">{{ config.get('MEETING_DEVICE_KEY', t('ui.value.na'))[:12] }}...</span>
                                            </div>
                                            <div class="info-row">
                                                <span class="info-label">{{ t('ui.home.cloud.heartbeat') }}</span>
                                                <span class="info-value" id="home-heartbeat-status">
                                                    <span class="status-dot status-active"></span> {{ t('ui.status.active') }}
                                                </span>
                                            </div>
                                        </div>
                                        {% else %}
                                        <div class="cloud-status cloud-unregistered">
                                            <div class="cloud-status-icon">
                                                <i class="fas fa-times-circle"></i>
                                            </div>
                                            <div class="cloud-status-text">
                                                <span class="cloud-status-title">{{ t('ui.home.cloud.unregistered_title') }}</span>
                                                <span class="cloud-status-subtitle">{{ t('ui.home.cloud.unregistered_subtitle') }}</span>
                                            </div>
                                        </div>
                                        <div class="cloud-action">
                                            <button type="button" class="btn btn-primary btn-sm" onclick="switchToTab('meeting')">
                                                <i class="fas fa-cog"></i> {{ t('ui.actions.configure') }}
                                            </button>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <!-- Stream URLs -->
                                <div class="home-card home-card-wide">
                                    <div class="home-card-header">
                                        <i class="fas fa-link"></i>
                                        <h3>{{ t('ui.home.stream_urls_title') }}</h3>
                                    </div>
                                    <div class="home-card-content">
                                        <div class="url-info-row">
                                            <span class="url-label"><i class="fas fa-video"></i> {{ t('ui.home.stream_rtsp') }}</span>
                                            <code class="url-value" id="home-rtsp-url">{{ rtsp_url }}</code>
                                            <button type="button" class="btn btn-icon btn-sm" onclick="copyToClipboard(document.getElementById('home-rtsp-url').textContent)">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="url-info-row">
                                            <span class="url-label"><i class="fas fa-eye"></i> {{ t('ui.home.stream_onvif') }}</span>
                                            <code class="url-value" id="home-onvif-url">{{ t('ui.loading') }}</code>
                                            <button type="button" class="btn btn-icon btn-sm" onclick="copyToClipboard(document.getElementById('home-onvif-url').textContent)">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- RTSP Tab -->
                    <div class="tab-content" id="tab-rtsp">
                        <div class="form-section">
                            <h4><i class="fas fa-video"></i> {{ t('ui.rtsp.config_title') }}</h4>
                            <small class="section-help">{{ t('ui.rtsp.config_help') }}</small>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="RTSP_PORT">
                                        <i class="fas fa-plug"></i> {{ t('ui.rtsp.port_label') }}
                                    </label>
                                    <input type="number" id="RTSP_PORT" name="RTSP_PORT" 
                                           value="{{ config.RTSP_PORT }}" min="1" max="65535">
                                    <small>{{ t('ui.rtsp.port_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="RTSP_PATH">
                                        <i class="fas fa-route"></i> {{ t('ui.rtsp.path_label') }}
                                    </label>
                                    <input type="text" id="RTSP_PATH" name="RTSP_PATH" 
                                           value="{{ config.RTSP_PATH }}">
                                    <small>{{ t('ui.rtsp.path_help') }}</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4><i class="fas fa-lock"></i> {{ t('ui.rtsp.auth_title') }}</h4>
                            <small class="section-help">{{ t('ui.rtsp.auth_help') }}</small>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="RTSP_USER">
                                        <i class="fas fa-user"></i> {{ t('ui.rtsp.user_label') }}
                                    </label>
                                    <input type="text" id="RTSP_USER" name="RTSP_USER" 
                                           value="{{ config.RTSP_USER }}"
                                           placeholder="{{ t('ui.rtsp.user_placeholder') }}">
                                    <small>{{ t('ui.rtsp.user_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="RTSP_PASSWORD">
                                        <i class="fas fa-key"></i> {{ t('ui.rtsp.password_label') }}
                                    </label>
                                    <div class="input-with-button">
                                        <input type="password" id="RTSP_PASSWORD" name="RTSP_PASSWORD" 
                                               value="{{ config.RTSP_PASSWORD }}"
                                               placeholder="{{ t('ui.rtsp.password_placeholder') }}">
                                        <button type="button" class="btn btn-icon" 
                                                onclick="togglePassword('RTSP_PASSWORD')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <small>{{ t('ui.rtsp.password_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="alert alert-info" id="rtsp-auth-status">
                                <i class="fas fa-info-circle"></i>
                                <span id="rtsp-auth-message">{{ t('ui.rtsp.auth_checking') }}</span>
                            </div>
                            
                            <div class="section-actions">
                                <button type="button" class="btn btn-primary" onclick="saveConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="resetForm()">
                                    <i class="fas fa-undo"></i> {{ t('ui.actions.reset') }}
                                </button>
                            </div>
                        </div>

                        <div class="form-section">
                            <h4><i class="fas fa-broadcast-tower"></i> {{ t('ui.rtsp.settings_title') }}</h4>
                            <small class="section-help">{{ t('ui.rtsp.settings_help') }}</small>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="VIDEO_FPS">
                                        <i class="fas fa-tachometer-alt"></i> {{ t('ui.video.fps_label') }}
                                    </label>
                                    <input type="number" id="VIDEO_FPS" name="VIDEO_FPS" 
                                           value="{{ config.VIDEO_FPS }}" min="1" max="60">
                                    <small>{{ t('ui.video.fps_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="H264_BITRATE_KBPS">
                                        <i class="fas fa-signal"></i> {{ t('ui.video.h264_bitrate_label') }}
                                    </label>
                                    <input type="number" id="H264_BITRATE_KBPS" name="H264_BITRATE_KBPS" 
                                           value="{{ config.H264_BITRATE_KBPS }}" min="500" max="8000">
                                    <small>{{ t('ui.video.h264_bitrate_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="H264_KEYINT">
                                        <i class="fas fa-key"></i> {{ t('ui.video.h264_keyint_label') }}
                                    </label>
                                    <input type="number" id="H264_KEYINT" name="H264_KEYINT" 
                                           value="{{ config.H264_KEYINT }}" min="10" max="120">
                                    <small>{{ t('ui.video.h264_keyint_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="H264_PROFILE">
                                        <i class="fas fa-layer-group"></i> {{ t('ui.video.h264_profile_label') }}
                                    </label>
                                    <select id="H264_PROFILE" name="H264_PROFILE">
                                        <option value="" {% if not config.H264_PROFILE %}selected{% endif %}>{{ t('ui.value.auto') }}</option>
                                        <option value="baseline" {% if config.H264_PROFILE == 'baseline' %}selected{% endif %}>{{ t('ui.h264.profile.baseline') }}</option>
                                        <option value="constrained baseline" {% if config.H264_PROFILE == 'constrained baseline' %}selected{% endif %}>{{ t('ui.h264.profile.constrained_baseline') }}</option>
                                        <option value="main" {% if config.H264_PROFILE == 'main' %}selected{% endif %}>{{ t('ui.h264.profile.main') }}</option>
                                        <option value="high" {% if config.H264_PROFILE == 'high' %}selected{% endif %}>{{ t('ui.h264.profile.high') }}</option>
                                    </select>
                                    <small>{{ t('ui.video.h264_profile_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="H264_QP">
                                        <i class="fas fa-sliders-h"></i> {{ t('ui.video.h264_qp_label') }}
                                    </label>
                                    <input type="number" id="H264_QP" name="H264_QP" 
                                           value="{{ config.H264_QP }}" min="1" max="51" placeholder="{{ t('ui.value.auto') }}">
                                    <small>{{ t('ui.video.h264_qp_help') }}</small>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_ENABLE">
                                        <i class="fas fa-text-height"></i> {{ t('ui.video.overlay_enable_label') }}
                                    </label>
                                    <select id="VIDEO_OVERLAY_ENABLE" name="VIDEO_OVERLAY_ENABLE">
                                        <option value="no" {% if config.VIDEO_OVERLAY_ENABLE != 'yes' %}selected{% endif %}>{{ t('ui.value.disabled') }}</option>
                                        <option value="yes" {% if config.VIDEO_OVERLAY_ENABLE == 'yes' %}selected{% endif %}>{{ t('ui.value.enabled') }}</option>
                                    </select>
                                    <small>{{ t('ui.video.overlay_enable_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_TEXT">
                                        <i class="fas fa-align-left"></i> {{ t('ui.video.overlay_text_label') }}
                                    </label>
                                    <input type="text" id="VIDEO_OVERLAY_TEXT" name="VIDEO_OVERLAY_TEXT"
                                           value="{{ config.VIDEO_OVERLAY_TEXT }}" placeholder="{CAMERA_TYPE} {VIDEO_RESOLUTION}">
                                    <small>{{ t('ui.video.overlay_text_help') }}</small>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="CSI_OVERLAY_MODE">
                                        <i class="fas fa-sliders-h"></i> {{ t('ui.video.csi_overlay_mode_label') }}
                                    </label>
                                    <select id="CSI_OVERLAY_MODE" name="CSI_OVERLAY_MODE">
                                        <option value="software" {% if config.CSI_OVERLAY_MODE != 'libcamera' %}selected{% endif %}>{{ t('ui.video.csi_overlay_mode_software') }}</option>
                                        <option value="libcamera" {% if config.CSI_OVERLAY_MODE == 'libcamera' %}selected{% endif %}>{{ t('ui.video.csi_overlay_mode_libcamera') }}</option>
                                    </select>
                                    <small>{{ t('ui.video.csi_overlay_mode_help') }}</small>
                                </div>
                            </div>
                            <div class="info-box warning" id="csi-overlay-warning" style="display: none;">
                                <h5><i class="fas fa-exclamation-triangle"></i> {{ t('ui.video.csi_overlay_warning_title') }}</h5>
                                <div class="info-text">{{ t('ui.video.csi_overlay_warning_text') }}</div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_POSITION">
                                        <i class="fas fa-map-pin"></i> {{ t('ui.video.overlay_position_label') }}
                                    </label>
                                    <select id="VIDEO_OVERLAY_POSITION" name="VIDEO_OVERLAY_POSITION">
                                        <option value="top-left" {% if config.VIDEO_OVERLAY_POSITION == 'top-left' %}selected{% endif %}>{{ t('ui.position.top_left') }}</option>
                                        <option value="top-right" {% if config.VIDEO_OVERLAY_POSITION == 'top-right' %}selected{% endif %}>{{ t('ui.position.top_right') }}</option>
                                        <option value="bottom-left" {% if config.VIDEO_OVERLAY_POSITION == 'bottom-left' %}selected{% endif %}>{{ t('ui.position.bottom_left') }}</option>
                                        <option value="bottom-right" {% if config.VIDEO_OVERLAY_POSITION == 'bottom-right' %}selected{% endif %}>{{ t('ui.position.bottom_right') }}</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_SHOW_DATETIME">
                                        <i class="fas fa-clock"></i> {{ t('ui.video.overlay_datetime_label') }}
                                    </label>
                                    <select id="VIDEO_OVERLAY_SHOW_DATETIME" name="VIDEO_OVERLAY_SHOW_DATETIME">
                                        <option value="no" {% if config.VIDEO_OVERLAY_SHOW_DATETIME != 'yes' %}selected{% endif %}>{{ t('ui.value.disabled') }}</option>
                                        <option value="yes" {% if config.VIDEO_OVERLAY_SHOW_DATETIME == 'yes' %}selected{% endif %}>{{ t('ui.value.enabled') }}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_DATETIME_FORMAT">
                                        <i class="fas fa-calendar-alt"></i> {{ t('ui.video.overlay_datetime_format_label') }}
                                    </label>
                                    <input type="text" id="VIDEO_OVERLAY_DATETIME_FORMAT" name="VIDEO_OVERLAY_DATETIME_FORMAT"
                                           value="{{ config.VIDEO_OVERLAY_DATETIME_FORMAT }}" placeholder="%Y-%m-%d %H:%M:%S">
                                    <small>{{ t('ui.video.overlay_datetime_format_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_CLOCK_POSITION">
                                        <i class="fas fa-map-pin"></i> {{ t('ui.video.overlay_clock_position_label') }}
                                    </label>
                                    <select id="VIDEO_OVERLAY_CLOCK_POSITION" name="VIDEO_OVERLAY_CLOCK_POSITION">
                                        <option value="top-left" {% if config.VIDEO_OVERLAY_CLOCK_POSITION == 'top-left' %}selected{% endif %}>{{ t('ui.position.top_left') }}</option>
                                        <option value="top-right" {% if config.VIDEO_OVERLAY_CLOCK_POSITION == 'top-right' %}selected{% endif %}>{{ t('ui.position.top_right') }}</option>
                                        <option value="bottom-left" {% if config.VIDEO_OVERLAY_CLOCK_POSITION == 'bottom-left' %}selected{% endif %}>{{ t('ui.position.bottom_left') }}</option>
                                        <option value="bottom-right" {% if config.VIDEO_OVERLAY_CLOCK_POSITION == 'bottom-right' %}selected{% endif %}>{{ t('ui.position.bottom_right') }}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="VIDEO_OVERLAY_FONT_SIZE">
                                        <i class="fas fa-font"></i> {{ t('ui.video.overlay_font_size_label') }}
                                    </label>
                                    <input type="number" id="VIDEO_OVERLAY_FONT_SIZE" name="VIDEO_OVERLAY_FONT_SIZE"
                                           value="{{ config.VIDEO_OVERLAY_FONT_SIZE }}" min="1" max="64">
                                    <small>{{ t('ui.video.overlay_font_size_help') }}</small>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <button type="button" class="btn btn-success btn-full" onclick="applyVideoSettings()">
                                <i class="fas fa-check"></i> {{ t('ui.rtsp.apply_settings') }}
                            </button>
                            <small class="hint">{{ t('ui.rtsp.apply_settings_help') }}</small>
                        </div>
                    </div>

                    <!-- ONVIF Tab (new separate tab) -->
                    <div class="tab-content" id="tab-onvif">
                        <div class="form-section">
                            <h4><i class="fas fa-eye"></i> {{ t('ui.onvif.title') }}</h4>
                            <small class="section-help">{{ t('ui.onvif.help') }}</small>
                            
                            <div class="onvif-status" id="onvif-status">
                                <div class="status-indicator">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.loading') }}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="toggle-label">
                                    <span><i class="fas fa-power-off"></i> {{ t('ui.onvif.enable') }}</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="onvif_enabled" name="onvif_enabled"
                                               onchange="toggleOnvifConfig()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </label>
                            </div>
                            
                            <div id="onvif-config" style="display: none;">
                                <!-- ONVIF URL Info -->
                                <div class="info-box info-box-highlight">
                                    <h5><i class="fas fa-link"></i> {{ t('ui.onvif.url_title') }}</h5>
                                    <div class="url-display">
                                        <code id="onvif-url-display">{{ t('ui.onvif.url_placeholder') }}</code>
                                        <button type="button" class="btn btn-icon btn-sm" onclick="copyOnvifUrl()">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                    <small>{{ t('ui.onvif.url_help') }}</small>
                                </div>
                                
                                <!-- ONVIF Video Info Box -->
                                <div class="info-box" id="onvif-video-info">
                                    <h5><i class="fas fa-video"></i> {{ t('ui.onvif.video_title') }}</h5>
                                    <p class="info-text">
                                        {{ t('ui.onvif.video_help') }}
                                    </p>
                                    <div class="onvif-video-stats">
                                        <span><i class="fas fa-expand"></i> {{ t('ui.onvif.resolution') }}: <strong id="onvif-resolution">-</strong></span>
                                        <span><i class="fas fa-tachometer-alt"></i> {{ t('ui.onvif.fps') }}: <strong id="onvif-fps">-</strong></span>
                                        <span><i class="fas fa-chart-line"></i> {{ t('ui.onvif.bitrate') }}: <strong id="onvif-bitrate">-</strong></span>
                                    </div>
                                    <small class="hint">{{ t('ui.onvif.video_hint') }}</small>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="onvif_port">
                                            <i class="fas fa-plug"></i> {{ t('ui.onvif.port_label') }}
                                        </label>
                                        <input type="number" id="onvif_port" name="onvif_port" 
                                               value="8080" min="1" max="65535">
                                        <small>{{ t('ui.onvif.port_help') }}</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="onvif_name">
                                            <i class="fas fa-tag"></i> {{ t('ui.onvif.camera_name_label') }}
                                            <span id="onvif_name_source" class="badge badge-info" style="font-size: 0.7em; margin-left: 5px; display: none;">{{ t('ui.onvif.meeting_api_badge') }}</span>
                                        </label>
                                        <input type="text" id="onvif_name" name="onvif_name" 
                                               placeholder="{{ t('ui.onvif.camera_name_placeholder') }}" readonly>
                                        <small id="onvif_name_hint">{{ t('ui.onvif.camera_name_hint') }}</small>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="onvif_username">
                                            <i class="fas fa-user"></i> {{ t('ui.onvif.username_label') }}
                                        </label>
                                        <input type="text" id="onvif_username" placeholder="{{ t('ui.onvif.username_placeholder') }}">
                                        <small>{{ t('ui.onvif.username_help') }}</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="onvif_password">
                                            <i class="fas fa-key"></i> {{ t('ui.onvif.password_label') }}
                                        </label>
                                        <div class="input-with-button">
                                            <input type="password" id="onvif_password" placeholder="{{ t('ui.onvif.password_placeholder') }}">
                                            <button type="button" class="btn btn-icon" onclick="togglePassword('onvif_password')">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <small>{{ t('ui.onvif.password_help') }}</small>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="onvif_rtsp_port">
                                            <i class="fas fa-network-wired"></i> {{ t('ui.onvif.rtsp_port_label') }}
                                        </label>
                                        <input type="number" id="onvif_rtsp_port" min="1" max="65535" value="8554">
                                        <small>{{ t('ui.onvif.rtsp_port_help') }}</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="onvif_rtsp_path">
                                            <i class="fas fa-link"></i> {{ t('ui.onvif.rtsp_path_label') }}
                                        </label>
                                        <input type="text" id="onvif_rtsp_path" placeholder="/stream">
                                        <small>{{ t('ui.onvif.rtsp_path_help') }}</small>
                                    </div>
                                </div>
                                
                                <div class="info-box info-box-highlight">
                                    <h5><i class="fas fa-lock"></i> {{ t('ui.onvif.shared_credentials_title') }}</h5>
                                    <p class="info-text">
                                        {{ t('ui.onvif.shared_credentials_help') }}
                                    </p>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="switchToTab('rtsp')">
                                        <i class="fas fa-arrow-right"></i> {{ t('ui.onvif.goto_rtsp_credentials') }}
                                    </button>
                                </div>
                                
                                <div class="button-group">
                                    <button type="button" class="btn btn-primary" onclick="saveOnvifConfig()">
                                        <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="restartOnvifService()">
                                        <i class="fas fa-sync"></i> {{ t('ui.onvif.restart_service') }}
                                    </button>
                                </div>
                            </div>
                            
                            <!-- ONVIF Help Section -->
                            <div class="help-section">
                                <h5><i class="fas fa-question-circle"></i> {{ t('ui.onvif.help_title') }}</h5>
                                <div class="help-content">
                                    <p><strong>{{ t('ui.onvif.help_what_title') }}</strong></p>
                                    <p>{{ t('ui.onvif.help_what_text') }}</p>
                                    <p><strong>{{ t('ui.onvif.help_software_title') }}</strong></p>
                                    <ul>
                                        <li>{{ t('ui.onvif.help_sw_synology') }}</li>
                                        <li>{{ t('ui.onvif.help_sw_blue_iris') }}</li>
                                        <li>{{ t('ui.onvif.help_sw_qnap') }}</li>
                                        <li>{{ t('ui.onvif.help_sw_ispy') }}</li>
                                        <li>{{ t('ui.onvif.help_sw_onvif_profile_s') }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Video Tab -->
                    <div class="tab-content" id="tab-video">
                        <!-- Video Preview Section -->
                        <div class="form-section preview-section">
                            <h4><i class="fas fa-eye"></i> {{ t('ui.video.preview_title') }}</h4>
                            <small class="section-help">{{ t('ui.video.preview_help') }}</small>
                            
                            <div class="preview-container">
                                <div class="preview-wrapper" id="preview-wrapper">
                                    <div class="preview-placeholder" id="preview-placeholder">
                                        <i class="fas fa-video-slash"></i>
                                        <p>{{ t('ui.video.preview_not_started') }}</p>
                                        <small>{{ t('ui.video.preview_start_hint') }}</small>
                                    </div>
                                    <img id="preview-stream" class="preview-stream" style="display: none;" alt="Preview">
                                </div>
                                <div class="preview-controls">
                                    <div class="preview-buttons">
                                        <button type="button" class="btn btn-success" id="btn-preview-start" onclick="startPreview()">
                                            <i class="fas fa-play"></i> {{ t('ui.actions.start') }}
                                        </button>
                                        <button type="button" class="btn btn-danger" id="btn-preview-stop" onclick="stopPreview()" style="display: none;">
                                            <i class="fas fa-stop"></i> {{ t('ui.actions.stop') }}
                                        </button>
                                        <button type="button" class="btn btn-secondary" onclick="takeSnapshot()">
                                            <i class="fas fa-camera"></i> {{ t('ui.actions.capture') }}
                                        </button>
                                    </div>
                                    <div class="preview-options">
                                        <label>
                                            <span>{{ t('ui.video.preview.source_label') }}:</span>
                                            <select id="preview-source">
                                                <option value="auto" selected>{{ t('ui.value.auto_recommended') }}</option>
                                                <option value="rtsp">{{ t('ui.video.preview.source_rtsp') }}</option>
                                                <option value="camera">{{ t('ui.video.preview.source_camera') }}</option>
                                            </select>
                                        </label>
                                        <label>
                                            <span>{{ t('ui.video.preview.quality_label') }}:</span>
                                            <select id="preview-quality">
                                                <option value="320x240">320x240 ({{ t('ui.video.preview.quality_low') }})</option>
                                                <option value="640x480" selected>640x480 ({{ t('ui.video.preview.quality_medium') }})</option>
                                                <option value="800x600">800x600 ({{ t('ui.video.preview.quality_high') }})</option>
                                            </select>
                                        </label>
                                    </div>
                                    <div class="preview-status">
                                        <span id="preview-status-text">
                                            <i class="fas fa-circle preview-status-dot inactive"></i> {{ t('ui.status.inactive') }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Video Device Section (first - camera selection) -->
                        <div class="form-section">
                            <h4><i class="fas fa-camera"></i> {{ t('ui.video.device_section_title') }}</h4>
                            <small class="section-help">{{ t('ui.video.device_section_help') }}</small>
                            
                            <div class="form-group">
                                <label for="VIDEO_DEVICE">
                                    <i class="fas fa-camera"></i> {{ t('ui.video.device_label') }}
                                </label>
                                <div class="input-with-button">
                                    <input type="text" id="VIDEO_DEVICE" name="VIDEO_DEVICE" 
                                           value="{{ config.VIDEO_DEVICE }}">
                                    <input type="hidden" id="VIDEO_FORMAT" name="VIDEO_FORMAT" value="{{ config.VIDEO_FORMAT or 'auto' }}">
                                    <button type="button" class="btn btn-secondary" onclick="detectCameras()">
                                        <i class="fas fa-search"></i> {{ t('ui.actions.detect') }}
                                    </button>
                                </div>
                                <small>{{ t('ui.video.device_help') }}</small>
                                <div id="camera-list" class="detection-list"></div>
                            </div>
                            <div class="form-group">
                                <label for="CAMERA_DEVICE">
                                    <i class="fas fa-sliders-h"></i> {{ t('ui.video.device_legacy_label') }}
                                </label>
                                <input type="text" id="CAMERA_DEVICE" name="CAMERA_DEVICE" 
                                       value="{{ config.get('CAMERA_DEVICE', config.VIDEO_DEVICE) }}">
                                <small>{{ t('ui.video.device_legacy_help') }}</small>
                            </div>
                            <div class="form-group">
                                <label for="CAMERA_TYPE">
                                    <i class="fas fa-camera"></i> {{ t('ui.video.camera_type_label') }}
                                </label>
                                <div class="camera-type-toggle">
                                    <input type="radio" id="cam_usb" name="CAMERA_TYPE" value="usb" 
                                        onchange="onCameraTypeChange()"
                                        {{ 'checked' if config.CAMERA_TYPE == 'usb' or config.CAMERA_TYPE == 'auto' }}>
                                    <label for="cam_usb" class="toggle-btn" title="{{ t('ui.video.camera_type_usb_title') }}">
                                        <i class="fab fa-usb"></i> USB
                                    </label>
                                    
                                    <input type="radio" id="cam_csi" name="CAMERA_TYPE" value="csi" 
                                        onchange="onCameraTypeChange()"
                                        {{ 'checked' if config.CAMERA_TYPE == 'csi' }}>
                                    <label for="cam_csi" class="toggle-btn" title="{{ t('ui.video.camera_type_csi_title') }}">
                                        <i class="fas fa-microchip"></i> CSI
                                    </label>
                                </div>
                                <small>{{ t('ui.video.camera_type_help') }}</small>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="CSI_ENABLE">
                                        <i class="fas fa-microchip"></i> {{ t('ui.video.csi_enable_label') }}
                                    </label>
                                    <select id="CSI_ENABLE" name="CSI_ENABLE">
                                        <option value="auto" {{ 'selected' if config.CSI_ENABLE == 'auto' or config.CSI_ENABLE not in ['yes', 'no'] }}>{{ t('ui.value.auto') }}</option>
                                        <option value="yes" {{ 'selected' if config.CSI_ENABLE == 'yes' }}>{{ t('ui.value.enabled') }}</option>
                                        <option value="no" {{ 'selected' if config.CSI_ENABLE == 'no' }}>{{ t('ui.value.disabled') }}</option>
                                    </select>
                                    <small>{{ t('ui.video.csi_enable_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="USB_ENABLE">
                                        <i class="fab fa-usb"></i> {{ t('ui.video.usb_enable_label') }}
                                    </label>
                                    <select id="USB_ENABLE" name="USB_ENABLE">
                                        <option value="auto" {{ 'selected' if config.USB_ENABLE == 'auto' or config.USB_ENABLE not in ['yes', 'no'] }}>{{ t('ui.value.auto') }}</option>
                                        <option value="yes" {{ 'selected' if config.USB_ENABLE == 'yes' }}>{{ t('ui.value.enabled') }}</option>
                                        <option value="no" {{ 'selected' if config.USB_ENABLE == 'no' }}>{{ t('ui.value.disabled') }}</option>
                                    </select>
                                    <small>{{ t('ui.video.usb_enable_help') }}</small>
                                </div>
                            </div>
                            <small>{{ t('ui.video.camera_type_auto_only') }}</small>
                        </div>
                        
                        <!-- Resolution Selection (second - camera format) -->
                        <div class="form-section">
                            <h4><i class="fas fa-expand-arrows-alt"></i> {{ t('ui.video.resolution_title') }}</h4>
                            <small class="section-help">{{ t('ui.video.resolution_help') }}</small>
                            
                            <div class="resolution-selector">
                                <div class="form-group">
                                    <label for="resolution-select">
                                        <i class="fas fa-list"></i> {{ t('ui.video.resolution_label') }}
                                        <span id="resolution-loading" class="loading-indicator" style="display: none;">
                                            <i class="fas fa-spinner fa-spin"></i> {{ t('ui.video.resolution_detecting') }}
                                        </span>
                                    </label>
                                    <select id="resolution-select" class="resolution-dropdown" onchange="onResolutionSelectChange(true)">
                                        <option value="">{{ t('ui.video.resolution_loading') }}</option>
                                    </select>
                                    <small>{{ t('ui.video.resolution_hint') }}</small>
                                </div>
                                
                                <div class="resolution-details" id="resolution-details" style="display: none;">
                                    <div class="detail-row">
                                        <span class="detail-label">{{ t('ui.video.detail_format') }}:</span>
                                        <span class="detail-value" id="detail-format">-</span>
                                    </div>
                                    <div class="detail-row">
                                        <span class="detail-label">{{ t('ui.video.detail_resolution') }}:</span>
                                        <span class="detail-value" id="detail-resolution">-</span>
                                    </div>
                                    <div class="detail-row">
                                        <span class="detail-label">{{ t('ui.video.detail_megapixels') }}:</span>
                                        <span class="detail-value" id="detail-megapixels">-</span>
                                    </div>
                                    <div class="detail-row">
                                        <span class="detail-label">{{ t('ui.video.detail_fps') }}:</span>
                                        <span class="detail-value" id="detail-fps">-</span>
                                    </div>
                                </div>
                                
                                <div class="manual-override">
                                    <label class="toggle-label">
                                        <span><i class="fas fa-edit"></i> {{ t('ui.video.manual_mode_label') }}</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="manual-resolution-mode" onchange="toggleManualResolution()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </label>
                                    <small>{{ t('ui.video.manual_mode_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="manual-resolution-fields" id="manual-resolution-fields" style="display: none;">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="VIDEO_WIDTH">
                                            <i class="fas fa-arrows-alt-h"></i> {{ t('ui.video.width_label') }}
                                        </label>
                                        <input type="number" id="VIDEO_WIDTH" name="VIDEO_WIDTH" 
                                               value="{{ config.VIDEO_WIDTH }}" min="320" max="4096">
                                        <small>{{ t('ui.video.width_help') }}</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="VIDEO_HEIGHT">
                                            <i class="fas fa-arrows-alt-v"></i> {{ t('ui.video.height_label') }}
                                        </label>
                                        <input type="number" id="VIDEO_HEIGHT" name="VIDEO_HEIGHT" 
                                               value="{{ config.VIDEO_HEIGHT }}" min="240" max="2160">
                                        <small>{{ t('ui.video.height_help') }}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Camera Controls Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-sliders-h"></i> {{ t('ui.video.camera_controls_title') }}</h4>
                            <small class="section-help">{{ t('ui.video.camera_controls_help') }}</small>
                            
                            <div class="camera-controls" id="camera-controls">
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-crosshairs"></i> {{ t('ui.video.autofocus_label') }}
                                    </label>
                                    <div class="autofocus-control">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="camera_autofocus" 
                                                   onchange="setCameraAutofocus(this.checked)">
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <span id="autofocus-status" class="control-status">{{ t('ui.loading') }}</span>
                                        <button type="button" class="btn btn-sm btn-secondary" onclick="triggerOneShotFocus()" title="{{ t('ui.video.focus_one_shot_title') }}">
                                            <i class="fas fa-bullseye"></i> {{ t('ui.video.focus_label') }}
                                        </button>
                                    </div>
                                    <small>{{ t('ui.video.autofocus_help') }}</small>
                                </div>
                                
                                <div class="form-group" id="manual-focus-group" style="display: none;">
                                    <label for="camera_focus">
                                        <i class="fas fa-search-plus"></i> {{ t('ui.video.manual_focus_label') }}
                                    </label>
                                    <div class="range-control">
                                        <input type="range" id="camera_focus" min="0" max="255" value="30"
                                               onchange="setCameraFocus(this.value)">
                                        <span id="focus-value" class="range-value">30</span>
                                    </div>
                                    <small>{{ t('ui.video.manual_focus_help') }}</small>
                                </div>
                                
                                <div class="camera-controls-buttons">
                                    <button type="button" class="btn btn-secondary" onclick="loadCameraControls()">
                                        <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="showAdvancedCameraControls()">
                                        <i class="fas fa-cogs"></i> {{ t('ui.video.advanced_settings') }}
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Advanced Camera Controls (Modal/Collapsible) -->
                        <div class="form-section collapsible" id="advanced-camera-section" style="display: none;">
                            <h4 onclick="toggleSection('advanced-camera-section')">
                                <i class="fas fa-chevron-down"></i>
                                <i class="fas fa-cogs"></i> {{ t('ui.video.advanced_controls_title') }}
                            </h4>
                            <small class="section-help">{{ t('ui.video.advanced_controls_help') }}</small>
                            
                            <div id="csi-controls-notice" class="info-box" style="display: none;">
                                <i class="fas fa-info-circle"></i>
                                <span>{{ t('ui.video.csi_controls_notice') }}</span>
                            </div>
                            <div id="advanced-camera-controls" class="advanced-controls-grid">
                                <p class="loading-text"><i class="fas fa-spinner fa-spin"></i> {{ t('ui.video.controls_loading') }}</p>
                            </div>
                            
                            <div class="advanced-controls-actions">
                                <button type="button" class="btn btn-secondary" onclick="loadAdvancedCameraControls()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="resetAdvancedControls()">
                                    <i class="fas fa-undo"></i> {{ t('ui.actions.reset_defaults') }}
                                </button>
                                <button type="button" class="btn btn-warning" onclick="restartRtspStream()" title="{{ t('ui.video.restart_stream_title') }}">
                                    <i class="fas fa-redo"></i> {{ t('ui.video.restart_stream') }}
                                </button>
                            </div>
                        </div>
                        
                        <!-- Camera Profiles Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-clock"></i> {{ t('ui.video.profiles_title') }}</h4>
                            <small class="section-help">{{ t('ui.video.profiles_help') }}</small>
                            
                              <div class="form-group">
                                  <label>
                                      <i class="fas fa-power-off"></i> {{ t('ui.video.profiles_scheduler_label') }}
                                  </label>
                                  <div class="scheduler-control">
                                      <label class="toggle-switch">
                                          <input type="checkbox" id="profiles_scheduler_enabled" 
                                                 onchange="toggleProfilesScheduler(this.checked)">
                                          <span class="toggle-slider"></span>
                                      </label>
                                      <span id="scheduler-status" class="control-status">{{ t('ui.status.disabled') }}</span>
                                  </div>
                                  <small>{{ t('ui.video.profiles_scheduler_help') }}</small>
                              </div>
                              <div class="form-group">
                                  <label for="CAMERA_PROFILES_FILE">
                                      <i class="fas fa-file-alt"></i> {{ t('ui.video.profiles_file_label') }}
                                  </label>
                                  <input type="text" id="CAMERA_PROFILES_FILE" name="CAMERA_PROFILES_FILE" 
                                         value="{{ config.CAMERA_PROFILES_FILE }}">
                                  <small>{{ t('ui.video.profiles_file_help') }}</small>
                              </div>
                            
                            <div id="camera-profiles-list" class="profiles-list">
                                <p class="loading-text"><i class="fas fa-spinner fa-spin"></i> {{ t('ui.video.profiles_loading') }}</p>
                            </div>
                            
                            <div class="profiles-actions">
                                <button type="button" class="btn btn-secondary" onclick="loadCameraProfiles()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="showAddProfileModal()">
                                    <i class="fas fa-plus"></i> {{ t('ui.video.new_profile') }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Audio Tab -->
                    <div class="tab-content" id="tab-audio">
                        <div class="form-group">
                            <label>
                                <i class="fas fa-volume-up"></i> {{ t('ui.audio.capture_label') }}
                            </label>
                            <div class="radio-toggle-group">
                                <label class="radio-toggle">
                                    <input type="radio" name="AUDIO_ENABLE" value="no" {{ 'checked' if config.AUDIO_ENABLE == 'no' }}>
                                    <span class="radio-toggle-btn">
                                        <i class="fas fa-volume-mute"></i> {{ t('ui.value.disabled') }}
                                    </span>
                                </label>
                                <label class="radio-toggle">
                                    <input type="radio" name="AUDIO_ENABLE" value="auto" {{ 'checked' if config.AUDIO_ENABLE == 'auto' or config.AUDIO_ENABLE not in ['yes', 'no'] }}>
                                    <span class="radio-toggle-btn">
                                        <i class="fas fa-magic"></i> {{ t('ui.value.auto') }}
                                    </span>
                                </label>
                                <label class="radio-toggle">
                                    <input type="radio" name="AUDIO_ENABLE" value="yes" {{ 'checked' if config.AUDIO_ENABLE == 'yes' }}>
                                    <span class="radio-toggle-btn">
                                        <i class="fas fa-volume-up"></i> {{ t('ui.value.enabled') }}
                                    </span>
                                </label>
                            </div>
                            <small>{{ t('ui.audio.capture_help') }}</small>
                        </div>
                        <div class="form-group">
                            <label for="AUDIO_DEVICE">
                                <i class="fas fa-microphone"></i> {{ t('ui.audio.device_label') }}
                            </label>
                            <div class="input-with-button">
                                <input type="text" id="AUDIO_DEVICE" name="AUDIO_DEVICE" 
                                       value="{{ config.AUDIO_DEVICE }}">
                                <button type="button" class="btn btn-secondary" onclick="detectAudio()">
                                    <i class="fas fa-search"></i> {{ t('ui.actions.detect') }}
                                </button>
                            </div>
                            <small>{{ t('ui.audio.device_help') }}</small>
                            <div id="audio-list" class="detection-list"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="AUDIO_RATE">
                                    <i class="fas fa-wave-square"></i> {{ t('ui.audio.rate_label') }}
                                </label>
                                <select id="AUDIO_RATE" name="AUDIO_RATE">
                                    <option value="22050" {{ 'selected' if config.AUDIO_RATE == '22050' }}>{{ t('ui.units.hz', value=22050) }}</option>
                                    <option value="44100" {{ 'selected' if config.AUDIO_RATE == '44100' }}>{{ t('ui.units.hz', value=44100) }}</option>
                                    <option value="48000" {{ 'selected' if config.AUDIO_RATE == '48000' }}>{{ t('ui.units.hz', value=48000) }}</option>
                                </select>
                                <small>{{ t('ui.audio.rate_help') }}</small>
                            </div>
                            <div class="form-group">
                                <label for="AUDIO_CHANNELS">
                                    <i class="fas fa-headphones"></i> {{ t('ui.audio.channels_label') }}
                                </label>
                                <select id="AUDIO_CHANNELS" name="AUDIO_CHANNELS">
                                    <option value="1" {{ 'selected' if config.AUDIO_CHANNELS == '1' }}>{{ t('ui.audio.channels_mono') }}</option>
                                    <option value="2" {{ 'selected' if config.AUDIO_CHANNELS == '2' }}>{{ t('ui.audio.channels_stereo') }}</option>
                                </select>
                                <small>{{ t('ui.audio.channels_help') }}</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="AUDIO_BITRATE_KBPS">
                                <i class="fas fa-signal"></i> {{ t('ui.audio.bitrate_label') }}
                            </label>
                            <input type="number" id="AUDIO_BITRATE_KBPS" name="AUDIO_BITRATE_KBPS" 
                                   value="{{ config.AUDIO_BITRATE_KBPS }}" min="32" max="320">
                            <small>{{ t('ui.audio.bitrate_help') }}</small>
                        </div>
                        <div class="form-group">
                            <label for="AUDIO_GAIN">
                                <i class="fas fa-volume-up"></i> {{ t('ui.audio.gain_label') }}
                            </label>
                            <div class="slider-with-value">
                                <input type="range" id="AUDIO_GAIN" name="AUDIO_GAIN" 
                                       min="0" max="3" step="0.1"
                                       value="{{ config.AUDIO_GAIN|default('1.0') }}"
                                       oninput="updateAudioGainDisplay(this.value)">
                                <span id="AUDIO_GAIN_VALUE" class="slider-value">{{ config.AUDIO_GAIN|default('1.0') }}x</span>
                            </div>
                            <small>{{ t('ui.audio.gain_help') }}</small>
                        </div>
                        
                        <div class="section-actions">
                            <button type="button" class="btn btn-primary" onclick="applyAudioConfig()">
                                <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetForm()">
                                <i class="fas fa-undo"></i> {{ t('ui.actions.reset') }}
                            </button>
                        </div>
                    </div>

                    <!-- Recording Tab -->
                    <div class="tab-content" id="tab-recording">
                        <div class="led-info-box" style="margin-bottom: 20px;">
                            <i class="fas fa-info-circle"></i>
                            <span>
                                <strong>{{ t('ui.recording.note_title') }}</strong> {{ t('ui.recording.note_body') }}<br>
                                {{ t('ui.recording.note_command_intro') }}<br>
                                <code style="background: var(--bg-color); padding: 4px 8px; border-radius: 4px; display: block; margin-top: 8px;">
                                    ffmpeg -i rtsp://localhost:8554/stream -c copy -f segment -segment_time 300 rec_%03d.ts
                                </code>
                            </span>
                        </div>
                        
                        <div class="form-group">
                            <label for="RECORD_ENABLE">
                                <i class="fas fa-circle-dot"></i> {{ t('ui.recording.enable_label') }}
                            </label>
                            <select id="RECORD_ENABLE" name="RECORD_ENABLE">
                                <option value="no" {{ 'selected' if config.RECORD_ENABLE == 'no' }}>{{ t('ui.recording.disabled_recommended') }}</option>
                                <option value="yes" {{ 'selected' if config.RECORD_ENABLE == 'yes' }}>{{ t('ui.value.enabled') }}</option>
                            </select>
                            <small>{{ t('ui.recording.enable_help') }}</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="RECORD_DIR">
                                <i class="fas fa-folder"></i> {{ t('ui.recording.dir_label') }}
                            </label>
                            <input type="text" id="RECORD_DIR" name="RECORD_DIR" 
                                   value="{{ config.RECORD_DIR }}">
                            <small>{{ t('ui.recording.dir_help') }}</small>
                        </div>
                        <div class="form-group">
                            <label for="SEGMENT_SECONDS">
                                <i class="fas fa-clock"></i> {{ t('ui.recording.segment_label') }}
                            </label>
                            <input type="number" id="SEGMENT_SECONDS" name="SEGMENT_SECONDS" 
                                   value="{{ config.SEGMENT_SECONDS }}" min="30" max="3600">
                            <small>{{ t('ui.recording.segment_help') }}</small>
                        </div>
                          <div class="form-group">
                              <label for="MIN_FREE_DISK_MB">
                                  <i class="fas fa-hdd"></i> {{ t('ui.recording.min_free_label') }}
                              </label>
                              <input type="number" id="MIN_FREE_DISK_MB" name="MIN_FREE_DISK_MB" 
                                     value="{{ config.MIN_FREE_DISK_MB }}" min="0" max="1000000">
                              <small>{{ t('ui.recording.min_free_help') }}</small>
                          </div>
                          <div class="form-group">
                              <label for="MAX_DISK_MB">
                                  <i class="fas fa-database"></i> {{ t('ui.recording.max_disk_label') }}
                              </label>
                              <input type="number" id="MAX_DISK_MB" name="MAX_DISK_MB" 
                                     value="{{ config.MAX_DISK_MB }}" min="0" max="1000000">
                              <small>{{ t('ui.recording.max_disk_help') }}</small>
                          </div>
                        
                        <div class="section-actions">
                            <button type="button" class="btn btn-primary" onclick="saveConfig()">
                                <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetForm()">
                                <i class="fas fa-undo"></i> {{ t('ui.actions.reset') }}
                            </button>
                        </div>
                    </div>

                    <!-- Files Tab (Recording Files Management) -->
                    <div class="tab-content" id="tab-files">
                        <div class="platform-info" style="margin-bottom: 20px;">
                            <i class="fas fa-folder-open"></i>
                            <span>{{ t('ui.files.header') }} - <strong>{{ t('ui.files.header_actions') }}</strong></span>
                        </div>

                        <!-- Storage Info Banner -->
                        <div class="files-storage-banner" id="files-storage-info">
                            <div class="storage-stat">
                                <i class="fas fa-film"></i>
                                <span class="stat-value" id="files-total-count">-</span>
                                <span class="stat-label">{{ t('ui.files.files_label') }}</span>
                            </div>
                            <div class="storage-stat">
                                <i class="fas fa-database"></i>
                                <span class="stat-value" id="files-total-size">-</span>
                                <span class="stat-label">{{ t('ui.files.used_label') }}</span>
                            </div>
                            <div class="storage-stat">
                                <i class="fas fa-hdd"></i>
                                <span class="stat-value" id="files-disk-available">-</span>
                                <span class="stat-label">{{ t('ui.files.available_label') }}</span>
                            </div>
                            <div class="storage-stat">
                                <i class="fas fa-chart-pie"></i>
                                <span class="stat-value" id="files-disk-used">-</span>
                                <span class="stat-label">{{ t('ui.files.usage_label') }}</span>
                            </div>
                            <div class="storage-stat">
                                <i class="fas fa-server"></i>
                                <span class="stat-value" id="files-disk-total">-</span>
                                <span class="stat-label">{{ t('ui.files.total_label') }}</span>
                            </div>
                            <div class="storage-stat storage-quota" id="files-quota-info" style="display: none;">
                                <!-- Populated by JS when quota is configured -->
                            </div>
                            <div class="storage-stat storage-quota" id="files-max-quota-info" style="display: none;">
                                <!-- Populated by JS when quota is configured -->
                            </div>
                            <div class="storage-stat">
                                <i class="fas fa-folder"></i>
                                <span class="stat-value stat-path" id="files-directory" title="">-</span>
                                <span class="stat-label">{{ t('ui.files.directory_label') }}</span>
                            </div>
                        </div>

                        <!-- Files Actions Bar -->
                        <div class="files-actions-bar">
                            <div class="files-actions-left">
                                <button type="button" class="btn btn-secondary" onclick="loadFilesList()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                                <div class="files-select-all">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="files-select-all" onchange="toggleSelectAllFiles()">
                                        <span>{{ t('ui.files.select_all') }}</span>
                                    </label>
                                </div>
                            </div>
                            <div class="files-actions-right">
                                <button type="button" class="btn btn-info" onclick="lockSelectedFiles()" title="{{ t('ui.files.lock_title') }}">
                                    <i class="fas fa-lock"></i> {{ t('ui.files.lock') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="unlockSelectedFiles()" title="{{ t('ui.files.unlock_title') }}">
                                    <i class="fas fa-lock-open"></i> {{ t('ui.files.unlock') }}
                                </button>
                                <button type="button" class="btn btn-danger" onclick="deleteSelectedFiles()" title="{{ t('ui.files.delete_title') }}">
                                    <i class="fas fa-trash"></i> {{ t('ui.actions.delete') }}
                                </button>
                            </div>
                        </div>

                        <!-- Filter and Sort -->
                        <div class="files-filter-bar">
                            <div class="filter-group">
                                <label><i class="fas fa-filter"></i> {{ t('ui.files.filter_label') }}:</label>
                                <select id="files-filter" onchange="applyFilesFilter()">
                                    <option value="all">{{ t('ui.files.filter_all') }}</option>
                                    <option value="locked">{{ t('ui.files.filter_locked') }}</option>
                                    <option value="unlocked">{{ t('ui.files.filter_unlocked') }}</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-sort"></i> {{ t('ui.files.sort_label') }}:</label>
                                <select id="files-sort" onchange="applyFilesSort()">
                                    <option value="date-desc">{{ t('ui.files.sort_date_desc') }}</option>
                                    <option value="date-asc">{{ t('ui.files.sort_date_asc') }}</option>
                                    <option value="name-asc">{{ t('ui.files.sort_name_asc') }}</option>
                                    <option value="name-desc">{{ t('ui.files.sort_name_desc') }}</option>
                                    <option value="size-desc">{{ t('ui.files.sort_size_desc') }}</option>
                                    <option value="size-asc">{{ t('ui.files.sort_size_asc') }}</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label><i class="fas fa-search"></i></label>
                                <input type="text" id="files-search" placeholder="{{ t('ui.files.search_placeholder') }}" oninput="applyFilesSearch()">
                            </div>
                        </div>

                        <!-- Files Grid -->
                        <div class="files-grid-container">
                            <div id="files-list" class="files-grid">
                                <div class="files-loading">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.files.loading') }}
                                </div>
                            </div>
                            
                            <!-- Pagination Controls -->
                            <div class="files-pagination" id="files-pagination">
                                <div class="pagination-info">
                                    <span id="pagination-range">-</span> {{ t('ui.files.pagination_of') }} <span id="pagination-total">0</span> {{ t('ui.files.files_label') }}
                                </div>
                                <div class="pagination-controls">
                                    <button type="button" class="btn-pagination" id="btn-first-page" onclick="goToPage(1)" title="{{ t('ui.files.first_page') }}" disabled>
                                        <i class="fas fa-angle-double-left"></i>
                                    </button>
                                    <button type="button" class="btn-pagination" id="btn-prev-page" onclick="goToPrevPage()" title="{{ t('ui.files.prev_page') }}" disabled>
                                        <i class="fas fa-angle-left"></i>
                                    </button>
                                    <span class="pagination-pages" id="pagination-pages">
                                        <!-- Generated dynamically -->
                                    </span>
                                    <button type="button" class="btn-pagination" id="btn-next-page" onclick="goToNextPage()" title="{{ t('ui.files.next_page') }}" disabled>
                                        <i class="fas fa-angle-right"></i>
                                    </button>
                                    <button type="button" class="btn-pagination" id="btn-last-page" onclick="goToPage('last')" title="{{ t('ui.files.last_page') }}" disabled>
                                        <i class="fas fa-angle-double-right"></i>
                                    </button>
                                </div>
                                <div class="pagination-per-page">
                                    <label>{{ t('ui.files.per_page') }}:</label>
                                    <select id="files-per-page" onchange="changePerPage()">
                                        <option value="10">10</option>
                                        <option value="20" selected>20</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Selection Info -->
                        <div class="files-selection-info" id="files-selection-info" style="display: none;">
                            <span><strong id="files-selected-count">0</strong> {{ t('ui.files.selected_count') }}</span>
                            <span class="separator">|</span>
                            <span>{{ t('ui.files.total_size') }}: <strong id="files-selected-size">0 {{ t('ui.units.bytes_short') }}</strong></span>
                        </div>

                        <!-- Video Player Modal -->
                        <div id="video-player-modal" class="modal" style="display: none;">
                            <div class="modal-content modal-video">
                                <div class="modal-header">
                                    <h3><i class="fas fa-play-circle"></i> <span id="video-player-title">{{ t('ui.files.playback_title') }}</span></h3>
                                    <button type="button" class="modal-close" onclick="closeVideoPlayer()">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <video id="video-player" controls autoplay playsinline>
                                        {{ t('ui.files.video_not_supported') }}
                                    </video>
                                    <div class="video-error" id="video-player-error" style="display: none;">
                                        <i class="fas fa-exclamation-triangle"></i> {{ t('ui.files.playback_error') }}
                                    </div>
                                    <div class="video-info" id="video-info">
                                        <span id="video-duration"></span>
                                        <span id="video-size"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Network Tab -->
                    <div class="tab-content" id="tab-network">
                        <div class="section-header">
                            <h3><i class="fas fa-network-wired"></i> {{ t('ui.network.title') }}</h3>
                            <div class="network-status-bar" id="network-header-status">
                                <span class="status-indicator {{ 'connected' if wifi_info.connected else 'disconnected' }}" id="network-header-indicator">
                                    {{ t('ui.network.connected') if wifi_info.connected else t('ui.network.disconnected') }}
                                </span>
                                <span class="wifi-ssid" id="network-header-ssid">{% if wifi_info.connected %}{{ wifi_info.ssid }}{% endif %}</span>
                                <span class="wifi-ip" id="network-header-ip">{% if wifi_info.connected %}{{ wifi_info.ip }}{% endif %}</span>
                            </div>
                        </div>

                        <!-- Interfaces Priority Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-sort-amount-up"></i> {{ t('ui.network.interfaces_priority_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.network.interfaces_priority_help') }}
                            </small>
                            <div id="network-interfaces-list" class="network-interfaces-list">
                                <div class="loading-placeholder">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.network.interfaces_loading') }}
                                </div>
                            </div>
                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="loadNetworkInterfaces()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveInterfacePriority()">
                                    <i class="fas fa-save"></i> {{ t('ui.network.apply_priority') }}
                                </button>
                            </div>
                        </div>

                        <!-- IP Configuration Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-cog"></i> {{ t('ui.network.ip_config_title') }}</h4>
                            <div class="form-group">
                                <label for="network_interface_select">
                                    <i class="fas fa-ethernet"></i> {{ t('ui.network.interface_label') }}
                                </label>
                                <select id="network_interface_select" name="network_interface_select">
                                    <option value="">{{ t('ui.network.interface_placeholder') }}</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="network_mode">
                                    <i class="fas fa-sliders-h"></i> {{ t('ui.network.mode_label') }}
                                </label>
                                <div class="radio-group">
                                    <label class="radio-option">
                                        <input type="radio" name="network_mode" value="dhcp" checked onchange="toggleNetworkMode()">
                                        <span class="radio-label"><i class="fas fa-magic"></i> {{ t('ui.network.mode_dhcp') }}</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="network_mode" value="static" onchange="toggleNetworkMode()">
                                        <span class="radio-label"><i class="fas fa-edit"></i> {{ t('ui.network.mode_static') }}</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div id="static-ip-config" class="static-ip-config" style="display: none;">
                                <div class="form-group">
                                    <label for="network_static_ip">
                                        <i class="fas fa-map-marker-alt"></i> {{ t('ui.network.static_ip_label') }}
                                    </label>
                                    <input type="text" id="network_static_ip" name="network_static_ip" 
                                           placeholder="192.168.1.100/24" pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}\/[0-9]{1,2}$">
                                    <small class="input-help">{{ t('ui.network.static_ip_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="network_gateway">
                                        <i class="fas fa-door-open"></i> {{ t('ui.network.gateway_label') }}
                                    </label>
                                    <input type="text" id="network_gateway" name="network_gateway" 
                                           placeholder="192.168.1.1" pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}$">
                                </div>
                                <div class="form-group">
                                    <label for="network_dns">
                                        <i class="fas fa-globe"></i> {{ t('ui.network.dns_label') }}
                                    </label>
                                    <input type="text" id="network_dns" name="network_dns" 
                                           placeholder="8.8.8.8, 8.8.4.4">
                                    <small class="input-help">{{ t('ui.network.dns_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="button-group">
                                <button type="button" class="btn btn-primary" onclick="applyNetworkConfig()">
                                    <i class="fas fa-check"></i> {{ t('ui.actions.apply_config') }}
                                </button>
                            </div>
                        </div>

                        <!-- Ethernet Priority & WiFi Auto-disable Section -->
                        <div class="form-section ethernet-priority-section">
                            <h4><i class="fas fa-ethernet"></i> {{ t('ui.network.ethernet_priority_title') }}</h4>
                            <small class="section-help">
                                <i class="fas fa-info-circle"></i> 
                                {{ t('ui.network.ethernet_priority_help') }}
                            </small>
                            
                            <div class="ethernet-wifi-status" id="ethernet-wifi-status">
                                <div class="status-grid-small">
                                    <div class="status-item">
                                        <i class="fas fa-ethernet"></i>
                                        <span>{{ t('ui.network.ethernet_status_label') }}:</span>
                                        <span id="eth-status-badge" class="badge badge-warning">{{ t('ui.status.checking') }}</span>
                                    </div>
                                    <div class="status-item">
                                        <i class="fas fa-wifi"></i>
                                        <span>{{ t('ui.network.wifi_status_label') }}:</span>
                                        <span id="wlan0-status-badge" class="badge badge-warning">{{ t('ui.status.checking') }}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <i class="fas fa-hand-paper"></i> {{ t('ui.network.wifi_override_label') }}
                                </label>
                                <div class="toggle-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="wifi_manual_override">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <span id="wifi-override-status" class="control-status">{{ t('ui.value.auto') }}</span>
                                </div>
                                <small>{{ t('ui.network.wifi_override_help') }}</small>
                            </div>
                            
                            <div class="button-group">
                                <button type="button" class="btn btn-primary" onclick="applyWifiOverride()">
                                    <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                                </button>
                            </div>
                        </div>

                        <!-- Access Point Mode Section -->
                        <div class="form-section access-point-section">
                            <h4><i class="fas fa-broadcast-tower"></i> {{ t('ui.network.ap_title') }}</h4>
                            <small class="section-help">
                                <i class="fas fa-info-circle"></i> 
                                {{ t('ui.network.ap_help') }}
                            </small>
                            
                            <!-- AP Status Banner -->
                            <div class="ap-status-banner" id="ap-status-banner">
                                <div class="ap-status-content">
                                    <i class="fas fa-circle" id="ap-status-icon"></i>
                                    <span id="ap-status-text">{{ t('ui.status.checking') }}</span>
                                    <span id="ap-clients-count" class="badge badge-info" style="display: none;">{{ t('ui.network.ap_clients', count=0) }}</span>
                                </div>
                            </div>
                            
                            <!-- AP Warning Alert -->
                            <div class="alert alert-warning ap-warning" id="ap-warning-alert" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                <div>
                                    <strong>{{ t('ui.network.ap_warning_title') }}</strong> {{ t('ui.network.ap_warning_text') }}
                                </div>
                            </div>
                            
                            <!-- AP Configuration (from Meeting) -->
                            <div class="ap-meeting-info">
                                <div class="info-banner">
                                    <i class="fab fa-meetup"></i>
                                    <span>{{ t('ui.network.ap_meeting_configured') }}</span>
                                    <button type="button" class="btn btn-small btn-secondary" onclick="loadApConfigFromMeeting()">
                                        <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                    </button>
                                </div>
                            </div>
                            
                            <div class="ap-config-display">
                                <div class="ap-param">
                                    <label><i class="fas fa-wifi"></i> {{ t('ui.network.ap_ssid_label') }}</label>
                                    <input type="text" id="ap_ssid" name="ap_ssid" class="input-locked" readonly 
                                           value="{{ ap_mode.get('ssid', '') or t('ui.network.ap_not_configured') }}"
                                           placeholder="{{ t('ui.network.ap_not_configured') }}">
                                </div>
                                <div class="ap-param">
                                    <label><i class="fas fa-key"></i> {{ t('ui.network.ap_password_label') }}</label>
                                    <input type="text" id="ap_password" name="ap_password" class="input-locked ap-password-visible" readonly
                                           value="{{ ap_mode.get('password', '') or t('ui.network.ap_not_configured') }}"
                                           placeholder="{{ t('ui.network.ap_not_configured') }}">
                                </div>
                                <div class="ap-param">
                                    <label><i class="fas fa-signal"></i> {{ t('ui.network.ap_channel_label') }}</label>
                                    <input type="text" id="ap_channel_display" value="Canal {{ ap_mode.get('channel', 11) }} (2462 MHz)" class="input-locked" readonly>
                                    <input type="hidden" id="ap_channel" value="{{ ap_mode.get('channel', 11) }}">
                                </div>
                                <div class="ap-param">
                                    <label><i class="fas fa-map-marker-alt"></i> {{ t('ui.network.ap_ip_label') }}</label>
                                    <input type="text" id="ap_ip" name="ap_ip" value="192.168.4.1" class="input-locked" readonly>
                                </div>
                            </div>
                            
                            <!-- AP Actions -->
                            <div class="button-group ap-actions">
                                <button type="button" class="btn btn-success" id="btn-start-ap" onclick="startAccessPoint()">
                                    <i class="fas fa-play"></i> {{ t('ui.network.ap_start') }}
                                </button>
                                <button type="button" class="btn btn-danger" id="btn-stop-ap" onclick="stopAccessPoint()" style="display: none;">
                                    <i class="fas fa-stop"></i> {{ t('ui.network.ap_stop') }}
                                </button>
                            </div>
                        </div>

                        <!-- Simple WiFi Configuration (shown if only 1 WiFi adapter) -->
                        <div class="form-section wifi-simple-section" id="wifi-simple-section" style="display: none;">
                            <h4><i class="fas fa-wifi"></i> {{ t('ui.network.wifi_simple_title') }}</h4>
                            <small class="section-help">
                                <i class="fas fa-info-circle"></i> 
                                {{ t('ui.network.wifi_simple_help') }}
                            </small>
                            
                            <!-- Current WiFi Status -->
                            <div class="wifi-simple-status" id="wifi-simple-status">
                                <div class="wifi-status-loading">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.loading') }}
                                </div>
                            </div>
                            
                            <!-- WiFi Network Config -->
                            <div class="network-config-box primary-network">
                                <div class="network-label">
                                    <i class="fas fa-wifi"></i> {{ t('ui.network.wifi_network_label') }}
                                </div>
                                <div class="form-group">
                                    <label for="wifi_simple_ssid">
                                        <i class="fas fa-broadcast-tower"></i> {{ t('ui.network.wifi_ssid_label') }}
                                    </label>
                                    <div class="input-with-button">
                                        <input type="text" id="wifi_simple_ssid" name="wifi_simple_ssid" 
                                               placeholder="{{ t('ui.network.wifi_ssid_placeholder') }}">
                                        <button type="button" class="btn btn-secondary btn-small" 
                                                onclick="scanWifiForField('wifi_simple_ssid')">
                                            <i class="fas fa-search"></i> {{ t('ui.actions.scan') }}
                                        </button>
                                    </div>
                                    <div id="wifi-simple-ssid-list" class="wifi-detection-list"></div>
                                </div>
                                <div class="form-group">
                                    <label for="wifi_simple_password">
                                        <i class="fas fa-key"></i> {{ t('ui.network.wifi_password_label') }}
                                    </label>
                                    <div class="input-with-button">
                                        <input type="password" id="wifi_simple_password" name="wifi_simple_password" 
                                               placeholder="{{ t('ui.network.wifi_password_placeholder') }}">
                                        <button type="button" class="btn btn-icon" 
                                                onclick="togglePassword('wifi_simple_password')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- IP Configuration -->
                            <div class="failover-subsection">
                                <h5><i class="fas fa-network-wired"></i> {{ t('ui.network.ip_config_title') }}</h5>
                                <div class="form-group">
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="wifi_simple_ip_mode" value="dhcp" checked 
                                                   onchange="toggleWifiSimpleIpMode()">
                                            <span class="radio-label"><i class="fas fa-magic"></i> {{ t('ui.network.mode_dhcp') }}</span>
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="wifi_simple_ip_mode" value="static" 
                                                   onchange="toggleWifiSimpleIpMode()">
                                            <span class="radio-label"><i class="fas fa-edit"></i> {{ t('ui.network.mode_static') }}</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div id="wifi-simple-static-config" class="static-ip-config" style="display: none;">
                                    <div class="form-group">
                                        <label for="wifi_simple_static_ip">
                                            <i class="fas fa-map-marker-alt"></i> {{ t('ui.network.static_ip_label') }}
                                        </label>
                                        <input type="text" id="wifi_simple_static_ip" 
                                               placeholder="192.168.1.100/24">
                                        <small>{{ t('ui.network.static_ip_help') }}</small>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="wifi_simple_gateway">
                                                <i class="fas fa-door-open"></i> {{ t('ui.network.gateway_label') }}
                                            </label>
                                            <input type="text" id="wifi_simple_gateway" 
                                                   placeholder="192.168.1.1">
                                        </div>
                                        <div class="form-group">
                                            <label for="wifi_simple_dns">
                                                <i class="fas fa-globe"></i> {{ t('ui.network.dns_label') }}
                                            </label>
                                            <input type="text" id="wifi_simple_dns" 
                                                   placeholder="8.8.8.8" value="8.8.8.8">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Actions -->
                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="loadWifiSimpleStatus()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveWifiSimpleConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                                </button>
                                <button type="button" class="btn btn-success" onclick="connectWifiSimple()">
                                    <i class="fas fa-plug"></i> {{ t('ui.network.connect') }}
                                </button>
                            </div>
                        </div>

                        <!-- WiFi Failover Section (hidden if < 2 WiFi adapters) -->
                        <div class="form-section wifi-failover-section" id="wifi-failover-section" style="display: none;">
                            <h4><i class="fas fa-wifi"></i> {{ t('ui.network.failover_title') }}</h4>
                            <small class="section-help">
                                <i class="fas fa-info-circle"></i> 
                                {{ t('ui.network.failover_help') }}
                            </small>
                            
                            <!-- WiFi Status Banner -->
                            <div class="wifi-failover-status" id="wifi-failover-status">
                                <div class="wifi-status-loading">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.loading') }}
                                </div>
                            </div>
                            
                            <!-- WiFi Interfaces Status -->
                            <div class="wifi-interfaces-grid" id="wifi-interfaces-grid">
                                <!-- Filled by JS -->
                            </div>
                            
                            <!-- === HARDWARE FAILOVER === -->
                            <div class="failover-subsection">
                                <h5><i class="fas fa-microchip"></i> {{ t('ui.network.failover_hw_title') }}</h5>
                                <small class="subsection-help">
                                    {{ t('ui.network.failover_hw_help') }}
                                </small>
                                
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-toggle-on"></i> {{ t('ui.network.failover_hw_enable_label') }}
                                    </label>
                                    <div class="toggle-control">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="wifi_hardware_failover_enabled" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <span id="wifi-hw-failover-status" class="control-status">{{ t('ui.value.enabled') }}</span>
                                    </div>
                                    <small>{{ t('ui.network.failover_hw_enable_help') }}</small>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="wifi_primary_interface">
                                            <i class="fas fa-star"></i> {{ t('ui.network.primary_interface_label') }}
                                        </label>
                                        <select id="wifi_primary_interface" name="wifi_primary_interface">
                                            <option value="wlan1">{{ t('ui.network.iface_wlan1_usb') }}</option>
                                            <option value="wlan0">{{ t('ui.network.iface_wlan0_builtin') }}</option>
                                        </select>
                                        <small>{{ t('ui.network.primary_interface_help') }}</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="wifi_secondary_interface">
                                            <i class="fas fa-life-ring"></i> {{ t('ui.network.secondary_interface_label') }}
                                        </label>
                                        <select id="wifi_secondary_interface" name="wifi_secondary_interface">
                                            <option value="wlan0">{{ t('ui.network.iface_wlan0_builtin') }}</option>
                                            <option value="wlan1">{{ t('ui.network.iface_wlan1_usb') }}</option>
                                        </select>
                                        <small>{{ t('ui.network.secondary_interface_help') }}</small>
                                    </div>
                                </div>
                                
                                <div class="subsection-actions">
                                    <button type="button" class="btn btn-primary btn-small" onclick="applyHardwareFailover()">
                                        <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                                    </button>
                                </div>
                            </div>
                            
                            <!-- === NETWORK FAILOVER === -->
                            <div class="failover-subsection">
                                <h5><i class="fas fa-broadcast-tower"></i> {{ t('ui.network.failover_network_title') }}</h5>
                                <small class="subsection-help">
                                    {{ t('ui.network.failover_network_help') }}
                                </small>
                                
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-toggle-on"></i> {{ t('ui.network.failover_network_enable_label') }}
                                    </label>
                                    <div class="toggle-control">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="wifi_network_failover_enabled" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <span id="wifi-net-failover-status" class="control-status">{{ t('ui.value.enabled') }}</span>
                                    </div>
                                    <small>{{ t('ui.network.failover_network_enable_help') }}</small>
                                </div>
                                
                                <!-- Primary Network -->
                                <div class="network-config-box primary-network">
                                    <div class="network-label">
                                        <i class="fas fa-star"></i> {{ t('ui.network.primary_network_label') }}
                                    </div>
                                    <div class="form-group">
                                        <label for="wifi_primary_ssid">
                                            <i class="fas fa-wifi"></i> SSID
                                        </label>
                                        <div class="input-with-button">
                                            <input type="text" id="wifi_primary_ssid" name="wifi_primary_ssid" 
                                                   placeholder="{{ t('ui.network.primary_ssid_placeholder') }}">
                                            <button type="button" class="btn btn-secondary btn-small" 
                                                    onclick="scanWifiForField('wifi_primary_ssid')">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                        <div id="wifi-primary-ssid-list" class="wifi-detection-list"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="wifi_primary_password">
                                            <i class="fas fa-key"></i> {{ t('ui.network.wifi_password_label') }}
                                        </label>
                                        <div class="input-with-button">
                                            <input type="password" id="wifi_primary_password" name="wifi_primary_password" 
                                                   placeholder="{{ t('ui.network.wifi_password_placeholder') }}">
                                            <button type="button" class="btn btn-icon" 
                                                    onclick="togglePassword('wifi_primary_password')">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Secondary Network -->
                                <div class="network-config-box secondary-network">
                                    <div class="network-label">
                                        <i class="fas fa-life-ring"></i> {{ t('ui.network.secondary_network_label') }}
                                    </div>
                                    <div class="form-group">
                                        <label for="wifi_secondary_ssid">
                                            <i class="fas fa-wifi"></i> SSID
                                        </label>
                                        <div class="input-with-button">
                                            <input type="text" id="wifi_secondary_ssid" name="wifi_secondary_ssid" 
                                                   placeholder="{{ t('ui.network.secondary_ssid_placeholder') }}">
                                            <button type="button" class="btn btn-secondary btn-small" 
                                                    onclick="scanWifiForField('wifi_secondary_ssid')">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                        <div id="wifi-secondary-ssid-list" class="wifi-detection-list"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="wifi_secondary_password">
                                            <i class="fas fa-key"></i> {{ t('ui.network.wifi_password_label') }}
                                        </label>
                                        <div class="input-with-button">
                                            <input type="password" id="wifi_secondary_password" name="wifi_secondary_password" 
                                                   placeholder="{{ t('ui.network.wifi_password_placeholder') }}">
                                            <button type="button" class="btn btn-icon" 
                                                    onclick="togglePassword('wifi_secondary_password')">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="subsection-actions">
                                    <button type="button" class="btn btn-primary btn-small" onclick="applyNetworkFailover()">
                                        <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                                    </button>
                                </div>
                            </div>
                            
                            <!-- === IP CONFIGURATION === -->
                            <div class="failover-subsection">
                                <h5><i class="fas fa-network-wired"></i> {{ t('ui.network.failover_ip_title') }}</h5>
                                <small class="subsection-help">
                                    {{ t('ui.network.failover_ip_help') }}
                                </small>
                                
                                <div class="form-group">
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="wifi_failover_ip_mode" value="dhcp" checked 
                                                   onchange="toggleWifiFailoverIpMode()">
                                            <span class="radio-label"><i class="fas fa-magic"></i> {{ t('ui.network.mode_dhcp') }}</span>
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="wifi_failover_ip_mode" value="static" 
                                                   onchange="toggleWifiFailoverIpMode()">
                                            <span class="radio-label"><i class="fas fa-edit"></i> {{ t('ui.network.mode_static') }}</span>
                                        </label>
                                    </div>
                                </div>
                                
                                  <div id="wifi-failover-static-config" class="static-ip-config" style="display: none;">
                                      <div class="form-group">
                                          <label for="wifi_failover_static_ip">
                                              <i class="fas fa-map-marker-alt"></i> {{ t('ui.network.static_ip_label') }}
                                          </label>
                                          <input type="text" id="wifi_failover_static_ip" 
                                                 placeholder="192.168.1.100/24">
                                          <small>{{ t('ui.network.static_ip_help') }}</small>
                                      </div>
                                      <div class="form-row">
                                          <div class="form-group">
                                              <label for="wifi_failover_gateway">
                                                  <i class="fas fa-door-open"></i> {{ t('ui.network.gateway_label') }}
                                              </label>
                                              <input type="text" id="wifi_failover_gateway" 
                                                     placeholder="192.168.1.1">
                                          </div>
                                          <div class="form-group">
                                              <label for="wifi_failover_dns">
                                                  <i class="fas fa-globe"></i> {{ t('ui.network.dns_label') }}
                                              </label>
                                              <input type="text" id="wifi_failover_dns" 
                                                     placeholder="8.8.8.8" value="8.8.8.8">
                                          </div>
                                      </div>
                                  </div>
                                  <div class="form-group">
                                      <label for="wifi_failover_check_interval">
                                          <i class="fas fa-stopwatch"></i> {{ t('ui.network.failover_interval_label') }}
                                      </label>
                                      <input type="number" id="wifi_failover_check_interval" min="5" max="300" value="30">
                                      <small>{{ t('ui.network.failover_interval_help') }}</small>
                                  </div>
                                  
                                  <div class="subsection-actions">
                                      <button type="button" class="btn btn-primary btn-small" onclick="applyIpConfig()">
                                          <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                                      </button>
                                </div>
                            </div>
                            
                            <!-- Actions globales -->
                            <div class="button-group wifi-failover-actions">
                                <button type="button" class="btn btn-secondary" onclick="loadWifiFailoverStatus()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveWifiFailoverConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.network.save_all') }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- System Tab (LEDs & GPU) -->
                    <div class="tab-content" id="tab-system">
                        <!-- Platform Info Banner -->
                        <div class="platform-info">
                            <i class="fas fa-microchip"></i>
                            <span>{{ t('ui.system.platform_label') }}: <strong>{{ platform.model }}</strong></span>
                            {% if system_info.os_name %}
                            <span class="os-name">{{ system_info.os_name }}</span>
                            {% endif %}
                        </div>

                        <!-- Combined Power & LED Management Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-bolt"></i> {{ t('ui.system.power_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.system.power_help') }}
                            </small>
                            
                            <div class="energy-status-box" id="energy-status">
                                <div class="energy-estimate">
                                    <i class="fas fa-calculator"></i>
                                    <span>{{ t('ui.system.estimated_savings') }}: <strong id="estimated-savings-ma">0 {{ t('ui.units.ma') }}</strong></span>
                                </div>
                            </div>
                            
                            <div class="power-controls">
                                <!-- LEDs Section Header -->
                                <div class="power-section-header">
                                    <i class="fas fa-lightbulb"></i> {{ t('ui.system.leds_title') }}
                                </div>

                                <!-- PWR LED -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="led-icon pwr {{ 'on' if led_status.pwr.enabled else 'off' }}">
                                            <i class="fas fa-circle"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.led_power_title') }}</strong>
                                            <small id="led-pwr-status">{{ t('ui.system.led_power_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~5 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="led_pwr" name="led_pwr" 
                                                   {{ 'checked' if led_status.pwr.enabled else '' }}
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- ACT LED -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="led-icon act {{ 'on' if led_status.act.enabled else 'off' }}">
                                            <i class="fas fa-circle"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.led_activity_title') }}</strong>
                                            <small id="led-act-status">{{ t('ui.system.led_activity_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~3 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="led_act" name="led_act" 
                                                   {{ 'checked' if led_status.act.enabled else '' }}
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Camera LED (CSI) -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="led-icon camera">
                                            <i class="fas fa-video"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.led_csi_title') }}</strong>
                                            <small id="led-camera-csi-status">{{ t('ui.system.led_csi_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~2 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="led_camera_csi" name="led_camera_csi"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Camera LED (USB) -->
                                <div class="power-control-item" id="usb-camera-led-control" style="display: none;">
                                    <div class="power-info">
                                        <span class="led-icon camera-usb">
                                            <i class="fas fa-usb"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.led_usb_title') }}</strong>
                                            <small id="led-camera-usb-status">{{ t('ui.system.led_usb_help') }}</small>
                                            <span class="badge badge-warning">{{ t('ui.system.led_usb_note') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="led_camera_usb" name="led_camera_usb"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Ethernet LED -->
                                <div class="power-control-item" id="eth-led-control">
                                    <div class="power-info">
                                        <span class="led-icon eth {{ 'on' if led_status.eth.enabled else 'off' if led_status.eth.available else 'na' }}">
                                            <i class="fas fa-ethernet"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.led_ethernet_title') }}</strong>
                                            <small id="led-eth-status">
                                                {% if led_status.eth.available %}
                                                {{ t('ui.system.led_ethernet_help') }}
                                                {% else %}
                                                {{ t('ui.system.led_ethernet_unavailable', model=platform.model) }}
                                                {% endif %}
                                            </small>
                                            {% if led_status.eth.available %}
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~5 mA') }}</span>
                                            {% else %}
                                            <span class="badge badge-secondary">{{ t('ui.system.not_supported') }}</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        {% if led_status.eth.available %}
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="led_eth" name="led_eth"
                                                   {{ 'checked' if led_status.eth.enabled else '' }}
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                        {% else %}
                                        <span class="toggle-unavailable" title="{{ t('ui.system.led_unavailable_title') }}">
                                            <i class="fas fa-ban"></i>
                                        </span>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- Components Section Header -->
                                <div class="power-section-header">
                                    <i class="fas fa-microchip"></i> {{ t('ui.system.components_title') }}
                                </div>

                                <!-- Bluetooth Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon bt">
                                            <i class="fas fa-bluetooth"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.bluetooth_title') }}</strong>
                                            <small id="bt-status">{{ t('ui.system.status_loading') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~20 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="power_bt" name="power_bt" 
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- WiFi Integrated Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon wifi">
                                            <i class="fas fa-wifi"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.wifi_integrated_title') }}</strong>
                                            <small id="wifi-integrated-status">{{ t('ui.system.status_loading') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~40 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="power_wifi" name="power_wifi"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- HDMI Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon hdmi">
                                            <i class="fas fa-display"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.hdmi_title') }}</strong>
                                            <small id="hdmi-status">{{ t('ui.system.status_loading') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~40 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="power_hdmi" name="power_hdmi"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Audio Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon audio">
                                            <i class="fas fa-volume-mute"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.audio_title') }}</strong>
                                            <small id="audio-status">{{ t('ui.system.status_loading') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~10 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="power_audio" name="power_audio"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Services Section Header -->
                                <div class="power-section-header">
                                    <i class="fas fa-cogs"></i> {{ t('ui.system.services_title') }}
                                </div>

                                <!-- ModemManager Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon service">
                                            <i class="fas fa-signal"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.modemmanager_title') }}</strong>
                                            <small id="modemmanager-status">{{ t('ui.system.modemmanager_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~15 mA + RAM') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="service_modemmanager" name="service_modemmanager"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Avahi Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon service">
                                            <i class="fas fa-broadcast-tower"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.avahi_title') }}</strong>
                                            <small id="avahi-status">{{ t('ui.system.avahi_help') }}</small>
                                            <span class="badge badge-warning">{{ t('ui.system.avahi_note') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="service_avahi" name="service_avahi"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Cloud-Init Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon service">
                                            <i class="fas fa-cloud"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.cloudinit_title') }}</strong>
                                            <small id="cloudinit-status">{{ t('ui.system.cloudinit_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.cloudinit_savings') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="service_cloudinit" name="service_cloudinit"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Console SÃ©rie Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon service">
                                            <i class="fas fa-terminal"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.serial_title') }}</strong>
                                            <small id="serial-status">{{ t('ui.system.serial_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings_serial') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="service_serial" name="service_serial"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- TTY1 Getty Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon service">
                                            <i class="fas fa-desktop"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.tty1_title') }}</strong>
                                            <small id="tty1-status">{{ t('ui.system.tty1_help') }}</small>
                                            <span class="badge badge-info">{{ t('ui.system.savings', value='~2 mA') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="service_tty1" name="service_tty1"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Udisks2 Control -->
                                <div class="power-control-item">
                                    <div class="power-info">
                                        <span class="power-icon service">
                                            <i class="fas fa-usb"></i>
                                        </span>
                                        <div class="power-details">
                                            <strong>{{ t('ui.system.udisks2_title') }}</strong>
                                            <small id="udisks2-status">{{ t('ui.system.udisks2_help') }}</small>
                                            <span class="badge badge-warning">{{ t('ui.system.udisks2_note') }}</span>
                                        </div>
                                    </div>
                                    <div class="power-actions">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="service_udisks2" name="service_udisks2"
                                                   onchange="markPowerSettingsChanged()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="power-info-box" style="margin-top: 15px;">
                                <i class="fas fa-info-circle"></i>
                                <span><strong>{{ t('ui.recording.note_title') }}</strong> {{ t('ui.system.power_note') }}</span>
                            </div>

                            <div class="power-apply-section" style="margin-top: 20px;">
                                <button type="button" class="btn btn-primary" id="btn-apply-power" onclick="applyPowerSettings()" disabled>
                                    <i class="fas fa-save"></i> {{ t('ui.system.apply_reboot_required') }}
                                </button>
                                <span id="power-changes-indicator" class="changes-indicator" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i> {{ t('ui.system.unsaved_changes') }}
                                </span>
                            </div>
                        </div>

                        <div class="form-section">
                            <h4><i class="fas fa-memory"></i> {{ t('ui.system.gpu_memory_title') }}</h4>
                            <small class="section-help">{{ t('ui.system.gpu_memory_help') }}</small>
                            
                            <div class="form-group">
                                <label for="gpu_mem">
                                    <i class="fas fa-microchip"></i> {{ t('ui.system.gpu_memory_label') }}
                                </label>
                                <select id="gpu_mem" name="gpu_mem">
                                    <option value="64" {{ 'selected' if gpu_mem.current == 64 }}>64 {{ t('ui.system.gpu_memory_min') }}</option>
                                    <option value="128" {{ 'selected' if gpu_mem.current == 128 }}>128 {{ t('ui.system.gpu_memory_default') }}</option>
                                    <option value="192" {{ 'selected' if gpu_mem.current == 192 }}>{{ t('ui.units.mb', value=192) }}</option>
                                    <option value="256" {{ 'selected' if gpu_mem.current == 256 }}>256 {{ t('ui.system.gpu_memory_recommended') }}</option>
                                    <option value="320" {{ 'selected' if gpu_mem.current == 320 }}>{{ t('ui.units.mb', value=320) }}</option>
                                    <option value="384" {{ 'selected' if gpu_mem.current == 384 }}>{{ t('ui.units.mb', value=384) }}</option>
                                    <option value="448" {{ 'selected' if gpu_mem.current == 448 }}>{{ t('ui.units.mb', value=448) }}</option>
                                    <option value="512" {{ 'selected' if gpu_mem.current == 512 }}>512 {{ t('ui.system.gpu_memory_max') }}</option>
                                </select>
                                <small>{{ t('ui.system.gpu_memory_current', current=gpu_mem.current, recommended=gpu_mem.recommended) }}</small>
                            </div>
                            <button type="button" class="btn btn-primary" onclick="setGpuMem()">
                                <i class="fas fa-save"></i> {{ t('ui.system.apply_reboot_required') }}
                            </button>
                        </div>

                        <!-- NTP Configuration -->
                        <div class="form-section">
                            <h4><i class="fas fa-clock"></i> {{ t('ui.system.ntp_title') }}</h4>
                            <small class="section-help">{{ t('ui.system.ntp_help') }}</small>
                            
                            <div class="ntp-status" id="ntp-status">
                                <div class="status-indicator">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.loading') }}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="ntp_server">
                                    <i class="fas fa-server"></i> {{ t('ui.system.ntp_server_label') }}
                                </label>
                                <div class="input-with-button">
                                    <input type="text" id="ntp_server" name="ntp_server" 
                                           placeholder="pool.ntp.org">
                                    <button type="button" class="btn btn-secondary btn-small" onclick="loadNtpConfig()">
                                        <i class="fas fa-sync"></i>
                                    </button>
                                </div>
                                <small>{{ t('ui.system.ntp_examples') }}</small>
                            </div>

                            <div class="form-group">
                                <label for="rtc_mode">
                                    <i class="fas fa-stopwatch"></i> {{ t('ui.system.rtc_label') }}
                                </label>
                                <select id="rtc_mode" name="rtc_mode">
                                    <option value="auto">{{ t('ui.system.rtc_auto') }}</option>
                                    <option value="enabled">{{ t('ui.system.rtc_enabled') }}</option>
                                    <option value="disabled">{{ t('ui.system.rtc_disabled') }}</option>
                                </select>
                                <small>{{ t('ui.system.rtc_help') }}</small>
                            </div>

                            <div class="rtc-status" id="rtc-status">
                                <div class="status-indicator">
                                    <i class="fas fa-spinner fa-spin"></i> {{ t('ui.loading') }}
                                </div>
                            </div>
                            <div class="button-group">
                                <button type="button" class="btn btn-primary" onclick="saveNtpConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.actions.apply') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="syncNtpNow()">
                                    <i class="fas fa-sync"></i> {{ t('ui.system.sync_now') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="loadRtcConfig()">
                                    <i class="fas fa-sync"></i> {{ t('ui.system.refresh_rtc') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveRtcConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.system.apply_rtc') }}
                                </button>
                            </div>
                        </div>

                        <!-- Scheduled Reboot -->
                        <div class="form-section scheduled-reboot">
                            <h4><i class="fas fa-redo-alt"></i> {{ t('ui.system.reboot_schedule_title') }}</h4>
                            <small class="section-help">{{ t('ui.system.reboot_schedule_help') }}</small>

                            <div class="reboot-toggle-row">
                                <label class="toggle-label">
                                    <span><i class="fas fa-toggle-on"></i> {{ t('ui.actions.enable') }}</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="reboot_schedule_enabled" onchange="updateRebootScheduleUiState()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </label>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="reboot_schedule_hour"><i class="fas fa-clock"></i> {{ t('ui.time.hour') }}</label>
                                    <select id="reboot_schedule_hour"></select>
                                </div>
                                <div class="form-group">
                                    <label for="reboot_schedule_minute"><i class="fas fa-clock"></i> {{ t('ui.time.minute') }}</label>
                                    <select id="reboot_schedule_minute"></select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label><i class="fas fa-calendar-alt"></i> {{ t('ui.time.days') }}</label>
                                <div class="reboot-days-grid" id="reboot-schedule-days">
                                    <label class="reboot-day"><input type="checkbox" value="all"> {{ t('ui.time.every_day') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="1"> {{ t('ui.time.monday') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="2"> {{ t('ui.time.tuesday') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="3"> {{ t('ui.time.wednesday') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="4"> {{ t('ui.time.thursday') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="5"> {{ t('ui.time.friday') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="6"> {{ t('ui.time.saturday') }}</label>
                                    <label class="reboot-day"><input type="checkbox" value="0"> {{ t('ui.time.sunday') }}</label>
                                </div>
                            </div>

                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="loadRebootSchedule()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.reload') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveRebootSchedule()">
                                    <i class="fas fa-save"></i> {{ t('ui.actions.apply') }}
                                </button>
                            </div>
                        </div>

                        <!-- SNMP Configuration -->
                        <div class="form-section">
                            <h4><i class="fas fa-network-wired"></i> {{ t('ui.system.snmp_title') }}</h4>
                            <small class="section-help">{{ t('ui.system.snmp_help') }}</small>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="toggle-label">
                                        <span><i class="fas fa-toggle-on"></i> {{ t('ui.system.snmp_enable') }}</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="snmp_enabled" onchange="updateSnmpUiState()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </label>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="snmp_host">
                                        <i class="fas fa-server"></i> {{ t('ui.system.snmp_host_label') }}
                                    </label>
                                    <input type="text" id="snmp_host" name="snmp_host" placeholder="192.168.1.10 ou snmp.local">
                                </div>
                                <div class="form-group">
                                    <label for="snmp_port">
                                        <i class="fas fa-plug"></i> {{ t('ui.system.snmp_port_label') }}
                                    </label>
                                    <input type="number" id="snmp_port" name="snmp_port" min="1" max="65535" placeholder="162">
                                </div>
                            </div>

                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="loadSnmpConfig()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.reload') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="testSnmpConfig()">
                                    <i class="fas fa-check"></i> {{ t('ui.actions.test') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveSnmpConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.actions.apply') }}
                                </button>
                            </div>
                        </div>

                        <!-- Repo Updater -->
                        <div class="form-section">
                            <h4><i class="fab fa-github"></i> {{ t('ui.updates.repo_title') }}</h4>
                            <small class="section-help">{{ t('ui.updates.repo_help') }}</small>
                            
                            <div class="update-status" id="update-status">
                                <div class="current-version">
                                    <span class="label">{{ t('ui.updates.current_version') }}:</span>
                                    <span class="version" id="current-version">v{{ app_version }}</span>
                                </div>
                                <div class="latest-version">
                                    <span class="label">{{ t('ui.updates.latest_version') }}:</span>
                                    <span class="version" id="latest-version">
                                        <i class="fas fa-spinner fa-spin"></i> {{ t('ui.status.checking') }}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="checkUpdateRepo()">
                                    <i class="fas fa-search"></i> {{ t('ui.updates.check_updates') }}
                                </button>
                                <button type="button" class="btn btn-primary" id="btn-update" onclick="openUpdateRepoModal()">
                                    <i class="fas fa-download"></i> {{ t('ui.updates.update_from_repo') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="openUpdateFilePicker()">
                                    <i class="fas fa-file-upload"></i> {{ t('ui.updates.update_from_file') }}
                                </button>
                            </div>
                            <input type="file" id="update-file-input"
                                   accept=".tar,.tar.gz,.tgz,.gz"
                                   style="display: none;"
                                   onchange="handleUpdateFileSelected(event)">
                        </div>

                        <!-- Backup / Restore -->
                        <div class="form-section">
                            <h4><i class="fas fa-archive"></i> {{ t('ui.backup.title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.backup.help') }}
                            </small>
                            
                            <div class="debug-action-status" id="backup-status">
                                <span class="status-label">{{ t('ui.status.label') }}:</span>
                                <span class="status-value" id="backup-status-text">{{ t('ui.status.pending') }}</span>
                            </div>
                            
                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="backupConfiguration()">
                                    <i class="fas fa-download"></i> {{ t('ui.backup.backup_config') }}
                                </button>
                                <button type="button" class="btn btn-primary" onclick="openBackupFilePicker('restore')">
                                    <i class="fas fa-upload"></i> {{ t('ui.backup.restore_config') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="openBackupFilePicker('check')">
                                    <i class="fas fa-check-circle"></i> {{ t('ui.backup.check_backup') }}
                                </button>
                            </div>
                            
                            <input type="file" id="backup-file-input"
                                   accept=".tar,.tar.gz,.tgz,.gz"
                                   style="display: none;"
                                   onchange="handleBackupFileSelected(event)">
                        </div>

                        <div class="form-section danger-zone">
                            <h4><i class="fas fa-exclamation-triangle"></i> {{ t('ui.system.actions_title') }}</h4>
                            <button type="button" class="btn btn-danger" onclick="confirmReboot()">
                                <i class="fas fa-redo"></i> {{ t('ui.system.reboot_now') }}
                            </button>
                        </div>
                    </div>

                    <!-- Meeting Tab -->
                    <div class="tab-content" id="tab-meeting">
                        <div class="platform-info" style="margin-bottom: 20px;">
                            <i class="fas fa-cloud"></i>
                            <span>{{ t('ui.meeting.header') }}</span>
                        </div>

                        <!-- Provisioning Status Banner -->
                        <div id="meeting-provisioned-banner" class="provisioned-banner" style="display: none;">
                            <div class="banner-content">
                                <i class="fas fa-lock"></i>
                                <div class="banner-text">
                                    <strong>{{ t('ui.meeting.provisioned') }}</strong>
                                    <span id="provisioned-device-key"></span>
                                </div>
                            </div>
                            <button type="button" class="btn btn-danger btn-small" onclick="showMasterResetModal()">
                                <i class="fas fa-unlock-alt"></i> {{ t('ui.meeting.master_reset') }}
                            </button>
                        </div>

                        <!-- Connection Status -->
                        <div class="form-section">
                            <h4><i class="fas fa-plug"></i> {{ t('ui.meeting.connection_status_title') }}</h4>
                            <div class="meeting-status" id="meeting-status">
                                <div class="status-card">
                                    <span class="status-indicator disconnected" id="meeting-connection-status">
                                        <i class="fas fa-circle"></i> {{ t('ui.meeting.not_configured') }}
                                    </span>
                                    <div class="status-details" id="meeting-status-details">
                                        <small>{{ t('ui.meeting.configure_hint') }}</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Provisioning Section (shown when not provisioned) -->
                        <div id="meeting-provisioning-section">
                            <div class="form-section">
                                <h4><i class="fas fa-rocket"></i> {{ t('ui.meeting.provisioning_title') }}</h4>
                                <p class="section-help">{{ t('ui.meeting.provisioning_help') }}</p>
                                
                                <div class="form-group">
                                    <label for="provision_api_url">
                                        <i class="fas fa-globe"></i> {{ t('ui.meeting.api_url_label') }}
                                    </label>
                                    <input type="text" id="provision_api_url" 
                                           value="https://meeting.ygsoft.fr/api"
                                           readonly
                                           class="input-locked"
                                           title="{{ t('ui.meeting.api_url_locked_title') }}">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="provision_device_key">
                                            <i class="fas fa-key"></i> Device Key
                                        </label>
                                        <input type="text" id="provision_device_key" 
                                               value="{{ config.MEETING_DEVICE_KEY }}"
                                               placeholder="ABCDEF123456789..."
                                               style="font-family: monospace; text-transform: uppercase;">
                                        <small>{{ t('ui.meeting.device_key_help') }}</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="provision_token_code">
                                            <i class="fas fa-ticket-alt"></i> {{ t('ui.meeting.token_code_label') }}
                                        </label>
                                        <div class="input-with-button">
                                            <input type="password" id="provision_token_code" 
                                                   value="{{ config.MEETING_TOKEN_CODE }}"
                                                   placeholder="token_secret"
                                                   style="font-family: monospace;">
                                            <button type="button" class="btn btn-icon" onclick="togglePassword('provision_token_code')">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <small>{{ t('ui.meeting.token_code_help') }}</small>
                                    </div>
                                </div>

                                <div class="provision-actions" style="margin-top: 20px;">
                                    <button type="button" class="btn btn-primary btn-large" onclick="validateMeetingCredentials()">
                                        <i class="fas fa-check-circle"></i> {{ t('ui.meeting.validate_credentials') }}
                                    </button>
                                    <button type="button" class="btn btn-success btn-large" id="btn-provision" onclick="provisionDevice()" disabled>
                                        <i class="fas fa-rocket"></i> {{ t('ui.meeting.provision_device') }}
                                    </button>
                                </div>
                                
                                <div id="provision-validation-result" class="meeting-result" style="display: none; margin-top: 15px;"></div>
                            </div>
                        </div>

                        <!-- Provisioned Configuration (shown when provisioned, read-only) -->
                        <div id="meeting-provisioned-config" style="display: none;">
                            <div class="form-section">
                                <h4><i class="fas fa-cog"></i> {{ t('ui.meeting.config_locked_title') }}</h4>
                                
                                <div class="form-group">
                                    <label><i class="fas fa-globe"></i> {{ t('ui.meeting.api_url_label') }}</label>
                                    <input type="text" id="MEETING_API_URL" name="MEETING_API_URL" 
                                           value="{{ config.MEETING_API_URL }}" readonly
                                           class="input-locked">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label><i class="fas fa-key"></i> {{ t('ui.meeting.device_key_label') }}</label>
                                        <input type="text" id="MEETING_DEVICE_KEY" name="MEETING_DEVICE_KEY" 
                                               value="{{ config.MEETING_DEVICE_KEY }}" readonly
                                               class="input-locked" style="font-family: monospace;">
                                    </div>
                                    <div class="form-group">
                                        <label><i class="fas fa-ticket-alt"></i> {{ t('ui.meeting.token_code_label') }}</label>
                                        <input type="password" id="MEETING_TOKEN_CODE" name="MEETING_TOKEN_CODE" 
                                               value="********" readonly
                                               class="input-locked" style="font-family: monospace;">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="MEETING_HEARTBEAT_INTERVAL">
                                        <i class="fas fa-heartbeat"></i> {{ t('ui.meeting.heartbeat_interval_label') }}
                                    </label>
                                    <input type="number" id="MEETING_HEARTBEAT_INTERVAL" name="MEETING_HEARTBEAT_INTERVAL" 
                                           value="{{ config.MEETING_HEARTBEAT_INTERVAL }}"
                                           min="10" max="300">
                                    <small>{{ t('ui.meeting.heartbeat_interval_help') }}</small>
                                </div>
                                
                                <!-- Hidden fields for form submission -->
                                <input type="hidden" name="MEETING_ENABLED" value="yes">
                                <input type="hidden" name="MEETING_PROVISIONED" value="yes">
                            </div>
                        </div>

                        <!-- Test & Actions (shown when provisioned) -->
                        <div id="meeting-actions-section" style="display: none;">
                            <div class="form-section">
                                <h4><i class="fas fa-vial"></i> {{ t('ui.actions.title') }}</h4>
                                <div class="meeting-actions">
                                    <button type="button" class="btn btn-success" onclick="sendMeetingHeartbeat()">
                                        <i class="fas fa-heartbeat"></i> {{ t('ui.meeting.send_heartbeat') }}
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="getMeetingAvailability()">
                                        <i class="fas fa-info-circle"></i> {{ t('ui.meeting.check_availability') }}
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="fetchMeetingDeviceInfo()">
                                        <i class="fas fa-sync"></i> {{ t('ui.meeting.device_info') }}
                                    </button>
                                </div>
                                <div id="meeting-test-result" class="meeting-result" style="display: none; margin-top: 15px;"></div>
                            </div>

                            <!-- Device Info from Meeting -->
                            <div class="form-section">
                                <h4><i class="fas fa-server"></i> {{ t('ui.meeting.device_info_title') }}</h4>
                                <div id="meeting-device-info" class="meeting-info-container">
                                    <p class="text-muted">{{ t('ui.meeting.device_info_hint') }}</p>
                                </div>
                            </div>

                            <!-- Tunnel Request -->
                            <div class="form-section">
                                <h4><i class="fas fa-project-diagram"></i> {{ t('ui.meeting.tunnels_title') }}</h4>
                                <small class="section-help">{{ t('ui.meeting.tunnels_help') }}</small>
                                
                                <div class="tunnel-controls" style="margin-top: 15px;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>{{ t('ui.meeting.tunnel_service_label') }}</label>
                                            <select id="meeting-tunnel-service">
                                                <option value="ssh">{{ t('ui.meeting.tunnel_ssh') }}</option>
                                                <option value="http">{{ t('ui.meeting.tunnel_http') }}</option>
                                                <option value="vnc">{{ t('ui.meeting.tunnel_vnc') }}</option>
                                                <option value="rtsp">{{ t('ui.meeting.tunnel_rtsp') }}</option>
                                            </select>
                                        </div>
                                        <div class="form-group" style="display: flex; align-items: flex-end;">
                                            <button type="button" class="btn btn-primary" onclick="requestMeetingTunnel()">
                                                <i class="fas fa-external-link-alt"></i> {{ t('ui.meeting.request_tunnel') }}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="meeting-tunnel-result" class="meeting-result" style="display: none; margin-top: 15px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Master Reset Modal -->
                    <div id="master-reset-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3><i class="fas fa-exclamation-triangle"></i> {{ t('ui.meeting.master_reset') }}</h3>
                                <button type="button" class="modal-close" onclick="closeMasterResetModal()">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p class="warning-text">
                                    <strong>{{ t('ui.meeting.warning_title') }}</strong> {{ t('ui.meeting.master_reset_warning') }}<br>
                                    {{ t('ui.meeting.master_reset_hostname_note') }}
                                </p>
                                <div class="form-group">
                                    <label for="master_reset_code">
                                        <i class="fas fa-key"></i> {{ t('ui.meeting.master_code_label') }}
                                    </label>
                                    <input type="password" id="master_reset_code" placeholder="{{ t('ui.meeting.master_code_placeholder') }}">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" onclick="closeMasterResetModal()">{{ t('ui.actions.cancel') }}</button>
                                <button type="button" class="btn btn-danger" onclick="executeMasterReset()">
                                    <i class="fas fa-unlock-alt"></i> {{ t('ui.meeting.reset') }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Tab -->
                    <div class="tab-content" id="tab-advanced">
                        <div class="form-group">
                            <label for="GST_DEBUG_LEVEL">
                                <i class="fas fa-bug"></i> {{ t('ui.advanced.gst_debug_label') }}
                            </label>
                            <select id="GST_DEBUG_LEVEL" name="GST_DEBUG_LEVEL">
                                <option value="0" {{ 'selected' if config.GST_DEBUG_LEVEL == '0' }}>0 - {{ t('ui.advanced.gst_debug_none') }}</option>
                                <option value="1" {{ 'selected' if config.GST_DEBUG_LEVEL == '1' }}>1 - {{ t('ui.advanced.gst_debug_errors') }}</option>
                                <option value="2" {{ 'selected' if config.GST_DEBUG_LEVEL == '2' }}>2 - {{ t('ui.advanced.gst_debug_warnings') }}</option>
                                <option value="3" {{ 'selected' if config.GST_DEBUG_LEVEL == '3' }}>3 - {{ t('ui.advanced.gst_debug_info') }}</option>
                                <option value="4" {{ 'selected' if config.GST_DEBUG_LEVEL == '4' }}>4 - {{ t('ui.advanced.gst_debug_debug') }}</option>
                                <option value="5" {{ 'selected' if config.GST_DEBUG_LEVEL == '5' }}>5 - {{ t('ui.advanced.gst_debug_log') }}</option>
                                <option value="6" {{ 'selected' if config.GST_DEBUG_LEVEL == '6' }}>6 - {{ t('ui.advanced.gst_debug_all') }}</option>
                            </select>
                            <small>{{ t('ui.advanced.gst_debug_help') }}</small>
                        </div>
                        <div class="form-group">
                            <label for="LOG_DIR">
                                <i class="fas fa-folder-open"></i> {{ t('ui.advanced.log_dir_label') }}
                            </label>
                            <input type="text" id="LOG_DIR" name="LOG_DIR" 
                                   value="{{ config.LOG_DIR }}">
                            <small>{{ t('ui.advanced.log_dir_help') }}</small>
                        </div>
                        <div class="form-group">
                            <label for="LOW_LATENCY">
                                <i class="fas fa-bolt"></i> {{ t('ui.advanced.low_latency_label') }}
                            </label>
                            <select id="LOW_LATENCY" name="LOW_LATENCY">
                                <option value="1" {{ 'selected' if config.LOW_LATENCY == '1' }}>{{ t('ui.value.enabled') }}</option>
                                <option value="0" {{ 'selected' if config.LOW_LATENCY == '0' }}>{{ t('ui.value.disabled') }}</option>
                            </select>
                            <small>{{ t('ui.advanced.low_latency_help') }}</small>
                        </div>
                    </div>

                    <!-- Logs Tab -->
                    <div class="tab-content" id="tab-logs">
                        <!-- Diagnostic Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-stethoscope"></i> {{ t('ui.logs.diagnostics_title') }}</h4>
                            <button type="button" class="btn btn-primary" onclick="runDiagnostic()">
                                <i class="fas fa-search"></i> {{ t('ui.logs.run_diagnostic') }}
                            </button>
                            <div id="diagnostic-results" class="diagnostic-container" style="display: none; margin-top: 15px;">
                                <div class="diagnostic-section">
                                    <h5><i class="fas fa-cog"></i> {{ t('ui.rtsp.service_label') }}</h5>
                                    <div id="diag-service"></div>
                                </div>
                                <div class="diagnostic-section">
                                    <h5><i class="fas fa-video"></i> {{ t('ui.gstreamer.label') }}</h5>
                                    <div id="diag-gstreamer"></div>
                                </div>
                                <div class="diagnostic-section">
                                    <h5><i class="fas fa-camera"></i> {{ t('ui.tabs.video') }}</h5>
                                    <div id="diag-camera"></div>
                                </div>
                                <div class="diagnostic-section">
                                    <h5><i class="fas fa-microphone"></i> {{ t('ui.tabs.audio') }}</h5>
                                    <div id="diag-audio"></div>
                                </div>
                                <div class="diagnostic-section">
                                    <h5><i class="fas fa-network-wired"></i> {{ t('ui.tabs.network') }}</h5>
                                    <div id="diag-network"></div>
                                </div>
                                <div class="diagnostic-section errors" id="diag-errors-section" style="display: none;">
                                    <h5><i class="fas fa-exclamation-triangle"></i> {{ t('ui.logs.errors_detected') }}</h5>
                                    <div id="diag-errors"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Logs Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-file-alt"></i> {{ t('ui.logs.service_logs_title') }}</h4>
                            <div class="logs-controls">
                                <div class="logs-buttons">
                                    <button type="button" class="btn btn-secondary" onclick="loadLogs()">
                                        <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="exportLogs()">
                                        <i class="fas fa-file-export"></i> {{ t('ui.logs.export_logs') }}
                                    </button>
                                    <button type="button" class="btn btn-primary" id="btn-live-logs" onclick="toggleLiveLogs()">
                                        <i class="fas fa-play"></i> {{ t('ui.logs.live_logs') }}
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="clearLogsDisplay()">
                                        <i class="fas fa-eraser"></i> {{ t('ui.logs.clear_display') }}
                                    </button>
                                    <button type="button" class="btn btn-danger" onclick="cleanServerLogs()">
                                        <i class="fas fa-trash-alt"></i> {{ t('ui.logs.clean_server_logs') }}
                                    </button>
                                </div>
                                <div class="logs-options">
                                    <select id="logs-source" onchange="loadLogs()">
                                        <option value="all">{{ t('ui.logs.source_all') }}</option>
                                        <option value="rtsp">{{ t('ui.logs.source_rtsp') }}</option>
                                        <option value="webmanager">{{ t('ui.logs.source_webmanager') }}</option>
                                        <option value="recorder">{{ t('ui.logs.source_recorder') }}</option>
                                        <option value="watchdog">{{ t('ui.logs.source_watchdog') }}</option>
                                        <option value="onvif">{{ t('ui.logs.source_onvif') }}</option>
                                        <option value="system">{{ t('ui.logs.source_system') }}</option>
                                        <option value="journald">{{ t('ui.logs.source_journald') }}</option>
                                        <option value="file-rtsp">{{ t('ui.logs.source_file_rtsp') }}</option>
                                        <option value="file-recorder">{{ t('ui.logs.source_file_recorder') }}</option>
                                        <option value="file-watchdog">{{ t('ui.logs.source_file_watchdog') }}</option>
                                        <option value="file-dnsmasq">{{ t('ui.logs.source_file_dnsmasq') }}</option>
                                        <option value="file-gstreamer">{{ t('ui.logs.source_file_gstreamer') }}</option>
                                        <option value="file-all">{{ t('ui.logs.source_file_all') }}</option>
                                    </select>
                                    <select id="logs-lines" onchange="loadLogs()">
                                        <option value="50">50 {{ t('ui.logs.lines') }}</option>
                                        <option value="100" selected>100 {{ t('ui.logs.lines') }}</option>
                                        <option value="200">200 {{ t('ui.logs.lines') }}</option>
                                        <option value="500">500 {{ t('ui.logs.lines') }}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="logs-status" id="logs-status">
                                <span id="logs-status-text">{{ t('ui.status.ready') }}</span>
                                <span id="live-indicator" class="live-indicator" style="display: none;">
                                    <i class="fas fa-circle blink"></i> {{ t('ui.logs.live_indicator') }}
                                </span>
                            </div>
                            <pre id="logs-content" class="logs-viewer">{{ t('ui.logs.hint') }}</pre>
                        </div>
                    </div>

                    {% if debug_enabled %}
                    <!-- Debug Tab -->
                    <div class="tab-content" id="tab-debug">
                        <!-- Warning Banner -->
                        <div class="debug-warning-banner">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>{{ t('ui.debug.warning') }}</span>
                        </div>

                        <!-- Meeting Local Config -->
                        <div class="form-section">
                            <h4><i class="fas fa-sliders-h"></i> {{ t('ui.debug.meeting_local_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.debug.meeting_local_help') }}
                            </small>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-toggle-on"></i> {{ t('ui.meeting.enable') }}
                                    </label>
                                    <div class="toggle-control">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="meeting_enabled_toggle">
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <span id="meeting-enabled-status" class="control-status">{{ t('ui.status.disabled') }}</span>
                                    </div>
                                    <small>{{ t('ui.debug.meeting_enabled_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-bolt"></i> {{ t('ui.debug.auto_connect_label') }}
                                    </label>
                                    <div class="toggle-control">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="meeting_auto_connect">
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <span id="meeting-auto-connect-status" class="control-status">{{ t('ui.status.disabled') }}</span>
                                    </div>
                                    <small>{{ t('ui.debug.auto_connect_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="meeting_config_api_url">
                                        <i class="fas fa-globe"></i> {{ t('ui.meeting.api_url_label') }}
                                    </label>
                                    <input type="text" id="meeting_config_api_url" placeholder="https://meeting.ygsoft.fr/api">
                                </div>
                                <div class="form-group">
                                    <label for="meeting_config_device_key">
                                        <i class="fas fa-key"></i> Device Key
                                    </label>
                                    <input type="text" id="meeting_config_device_key" placeholder="ABCDEF123456789...">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="meeting_config_token_code">
                                        <i class="fas fa-ticket-alt"></i> {{ t('ui.meeting.token_code_label') }}
                                    </label>
                                    <div class="input-with-button">
                                        <input type="password" id="meeting_config_token_code" placeholder="{{ t('ui.network.wifi_password_placeholder') }}">
                                        <button type="button" class="btn btn-icon" onclick="togglePassword('meeting_config_token_code')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <small>{{ t('ui.debug.token_update_help') }}</small>
                                </div>
                                <div class="form-group">
                                    <label for="meeting_config_heartbeat_interval">
                                        <i class="fas fa-heartbeat"></i> {{ t('ui.meeting.heartbeat_interval_label') }}
                                    </label>
                                    <input type="number" id="meeting_config_heartbeat_interval" min="10" max="300" value="30">
                                    <small>{{ t('ui.debug.heartbeat_interval_help') }}</small>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <i class="fas fa-shield-alt"></i> {{ t('ui.meeting.provisioned') }}
                                </label>
                                <span id="meeting_config_provisioned" class="badge badge-info">-</span>
                            </div>
                            
                            <div class="button-group">
                                <button type="button" class="btn btn-primary" onclick="saveMeetingConfig()">
                                    <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="loadMeetingConfig()">
                                    <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                </button>
                            </div>
                        </div>

                        <!-- RTC Debug Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-clock"></i> {{ t('ui.debug.rtc_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.debug.rtc_help') }}
                            </small>
                            <div class="debug-action-card">
                                <div class="debug-action-info">
                                    <div class="debug-action-status" id="rtc-debug-status">
                                        <span class="status-label">{{ t('ui.status.label') }}:</span>
                                        <span class="status-value" id="rtc-debug-status-text">{{ t('ui.loading') }}</span>
                                    </div>
                                    <div class="debug-action-details" id="rtc-debug-details">
                                        <small>{{ t('ui.debug.rtc_refresh_hint') }}</small>
                                    </div>
                                </div>
                                <div class="debug-action-buttons">
                                    <button type="button" class="btn btn-secondary" onclick="loadRtcDebug()">
                                        <i class="fas fa-sync"></i> {{ t('ui.actions.refresh') }}
                                    </button>
                                </div>
                            </div>
                            <div class="debug-output-container" id="rtc-output-container" style="display: none;">
                                <div class="debug-output-header">
                                    <span><i class="fas fa-terminal"></i> {{ t('ui.debug.rtc_details') }}</span>
                                    <button type="button" class="btn-icon" onclick="toggleDebugOutput('rtc')">
                                        <i class="fas fa-chevron-down" id="rtc-output-toggle"></i>
                                    </button>
                                </div>
                                <pre class="debug-output" id="rtc-debug-output"></pre>
                            </div>
                        </div>

                        <!-- Firmware Update Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-microchip"></i> {{ t('ui.debug.firmware_title') }}</h4>
                            <small class="section-help">
                                <strong>{{ t('ui.debug.firmware_pi45') }}</strong> <code>rpi-eeprom-update</code><br>
                                <strong>{{ t('ui.debug.firmware_pi32') }}</strong> <code>rpi-update</code> {{ t('ui.debug.firmware_experimental') }}
                            </small>
                            <div class="debug-action-card">
                                <div class="debug-action-info">
                                    <div class="debug-action-status" id="firmware-status">
                                        <span class="status-label">{{ t('ui.status.label') }}:</span>
                                        <span class="status-value" id="firmware-status-text">{{ t('ui.status.not_checked') }}</span>
                                    </div>
                                    <div class="debug-action-details" id="firmware-details">
                                        <small>{{ t('ui.debug.firmware_check_hint') }}</small>
                                    </div>
                                    <div class="debug-action-last-run" id="firmware-last-run">
                                        <small><i class="fas fa-history"></i> {{ t('ui.debug.firmware_last_check') }}: <span id="firmware-last-date">{{ t('ui.status.never') }}</span></small>
                                    </div>
                                    <div class="debug-action-method" id="firmware-method" style="display: none;">
                                        <span class="badge badge-info" id="firmware-method-badge"></span>
                                    </div>
                                </div>
                                <div class="debug-action-buttons">
                                    <button type="button" class="btn btn-secondary" onclick="checkFirmwareUpdate()" id="btn-check-firmware">
                                        <i class="fas fa-search"></i> {{ t('ui.actions.check') }}
                                    </button>
                                    <button type="button" class="btn btn-warning" onclick="runFirmwareUpdate()" id="btn-update-firmware" disabled>
                                        <i class="fas fa-download"></i> {{ t('ui.actions.update') }}
                                    </button>
                                </div>
                            </div>
                            <div class="debug-output-container" id="firmware-output-container" style="display: none;">
                                <div class="debug-output-header">
                                    <span><i class="fas fa-terminal"></i> {{ t('ui.debug.command_output') }}</span>
                                    <button type="button" class="btn-icon" onclick="toggleDebugOutput('firmware')">
                                        <i class="fas fa-chevron-down" id="firmware-output-toggle"></i>
                                    </button>
                                </div>
                                <pre class="debug-output" id="firmware-output"></pre>
                            </div>
                        </div>

                        <!-- APT Update Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-sync-alt"></i> {{ t('ui.debug.apt_update_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.debug.apt_update_help') }}
                            </small>
                            <div class="debug-action-card">
                                <div class="debug-action-info">
                                    <div class="debug-action-status" id="apt-update-status">
                                        <span class="status-label">{{ t('ui.status.label') }}:</span>
                                        <span class="status-value" id="apt-update-status-text">{{ t('ui.status.not_run') }}</span>
                                    </div>
                                    <div class="debug-action-details" id="apt-update-details">
                                        <small>{{ t('ui.debug.apt_update_details') }}</small>
                                    </div>
                                    <div class="debug-action-last-run" id="apt-update-last-run">
                                        <small><i class="fas fa-history"></i> {{ t('ui.debug.last_run') }}: <span id="apt-update-last-date">{{ t('ui.status.never') }}</span></small>
                                    </div>
                                </div>
                                <div class="debug-action-buttons">
                                    <button type="button" class="btn btn-primary" onclick="runAptUpdate()" id="btn-apt-update">
                                        <i class="fas fa-sync"></i> {{ t('ui.debug.run_apt_update') }}
                                    </button>
                                </div>
                            </div>
                            <div class="debug-output-container" id="apt-update-output-container" style="display: none;">
                                <div class="debug-output-header">
                                    <span><i class="fas fa-terminal"></i> {{ t('ui.debug.command_output') }}</span>
                                    <button type="button" class="btn-icon" onclick="toggleDebugOutput('apt-update')">
                                        <i class="fas fa-chevron-down" id="apt-update-output-toggle"></i>
                                    </button>
                                </div>
                                <pre class="debug-output" id="apt-update-output"></pre>
                            </div>
                        </div>

                        <!-- APT Upgrade Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-arrow-up"></i> {{ t('ui.debug.apt_upgrade_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.debug.apt_upgrade_help') }}
                            </small>
                            <div class="debug-action-card">
                                <div class="debug-action-info">
                                    <div class="debug-action-status" id="apt-upgrade-status">
                                        <span class="status-label">{{ t('ui.status.label') }}:</span>
                                        <span class="status-value" id="apt-upgrade-status-text">{{ t('ui.status.not_checked') }}</span>
                                    </div>
                                    <div class="debug-action-details" id="apt-upgrade-details">
                                        <small>{{ t('ui.debug.apt_upgrade_details') }}</small>
                                    </div>
                                    <div class="debug-action-last-run" id="apt-upgrade-last-run">
                                        <small><i class="fas fa-history"></i> {{ t('ui.debug.last_run') }}: <span id="apt-upgrade-last-date">{{ t('ui.status.never') }}</span></small>
                                    </div>
                                </div>
                                <div class="debug-action-buttons">
                                    <button type="button" class="btn btn-secondary" onclick="checkAptUpgradable()" id="btn-check-upgradable">
                                        <i class="fas fa-list"></i> {{ t('ui.debug.view_packages') }}
                                    </button>
                                    <button type="button" class="btn btn-warning" onclick="runAptUpgrade()" id="btn-apt-upgrade">
                                        <i class="fas fa-arrow-up"></i> {{ t('ui.actions.update') }}
                                    </button>
                                </div>
                            </div>
                            <div class="debug-output-container" id="apt-upgrade-output-container" style="display: none;">
                                <div class="debug-output-header">
                                    <span><i class="fas fa-terminal"></i> {{ t('ui.debug.command_output') }}</span>
                                    <button type="button" class="btn-icon" onclick="toggleDebugOutput('apt-upgrade')">
                                        <i class="fas fa-chevron-down" id="apt-upgrade-output-toggle"></i>
                                    </button>
                                </div>
                                <pre class="debug-output" id="apt-upgrade-output"></pre>
                            </div>
                        </div>

                        <!-- APT Auto-Update Scheduler Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-calendar-alt"></i> {{ t('ui.debug.scheduler_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.debug.scheduler_help') }}
                            </small>
                            <div class="scheduler-card">
                                <div class="scheduler-toggle">
                                    <div class="scheduler-info">
                                        <strong><i class="fas fa-clock"></i> {{ t('ui.debug.scheduler_enable') }}</strong>
                                        <small id="scheduler-status-text">{{ t('ui.status.disabled') }}</small>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="apt-scheduler-enabled" onchange="toggleAptScheduler()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                
                                <div class="scheduler-config" id="scheduler-config" style="display: none;">
                                    <div class="scheduler-row">
                                        <label><i class="fas fa-sync-alt"></i> {{ t('ui.debug.scheduler_daily_update') }}</label>
                                        <div class="time-picker">
                                            <select id="scheduler-update-hour">
                                                {% for h in range(24) %}
                                                <option value="{{ h }}" {{ 'selected' if h == 3 else '' }}>{{ '%02d'|format(h) }}</option>
                                                {% endfor %}
                                            </select>
                                            <span>:</span>
                                            <select id="scheduler-update-minute">
                                                <option value="0" selected>00</option>
                                                <option value="15">15</option>
                                                <option value="30">30</option>
                                                <option value="45">45</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="scheduler-row">
                                        <label>
                                            <input type="checkbox" id="scheduler-upgrade-enabled" onchange="updateSchedulerConfig()">
                                            <i class="fas fa-arrow-up"></i> {{ t('ui.debug.scheduler_weekly_upgrade') }}
                                        </label>
                                    </div>
                                    
                                    <div class="scheduler-row" id="scheduler-upgrade-day-row" style="display: none;">
                                        <label><i class="fas fa-calendar-week"></i> {{ t('ui.time.day_of_week') }}:</label>
                                        <select id="scheduler-upgrade-day" onchange="updateSchedulerConfig()">
                                            <option value="0">{{ t('ui.time.sunday') }}</option>
                                            <option value="1">{{ t('ui.time.monday') }}</option>
                                            <option value="2">{{ t('ui.time.tuesday') }}</option>
                                            <option value="3">{{ t('ui.time.wednesday') }}</option>
                                            <option value="4">{{ t('ui.time.thursday') }}</option>
                                            <option value="5">{{ t('ui.time.friday') }}</option>
                                            <option value="6">{{ t('ui.time.saturday') }}</option>
                                        </select>
                                    </div>
                                    
                                    <div class="scheduler-actions">
                                        <button type="button" class="btn btn-primary" onclick="saveAptScheduler()" id="btn-save-scheduler">
                                            <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Web Terminal Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-terminal"></i> {{ t('ui.debug.terminal_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.debug.terminal_help') }}
                            </small>
                            <div class="terminal-container">
                                <div class="terminal-output" id="terminal-output">
                                    <div class="terminal-line terminal-info">
                                        <span>{{ t('ui.debug.terminal_welcome') }}</span>
                                    </div>
                                    <div class="terminal-line terminal-info">
                                        <span>{{ t('ui.debug.terminal_help_hint') }}</span>
                                    </div>
                                </div>
                                <div class="terminal-input-line">
                                    <span class="terminal-prompt">{{ t('ui.debug.terminal_prompt') }}</span>
                                    <input type="text" id="terminal-input" class="terminal-input" 
                                           placeholder="{{ t('ui.debug.terminal_command_placeholder') }}" 
                                           autocomplete="off" spellcheck="false"
                                           onkeydown="handleTerminalKeydown(event)">
                                    <button type="button" class="btn btn-sm btn-primary" onclick="executeTerminalCommand()">
                                        <i class="fas fa-play"></i>
                                    </button>
                                </div>
                                <div class="terminal-toolbar">
                                    <button type="button" class="btn btn-sm btn-secondary" onclick="clearTerminal()">
                                        <i class="fas fa-eraser"></i> {{ t('ui.actions.clear') }}
                                    </button>
                                    <button type="button" class="btn btn-sm btn-secondary" onclick="showAllowedCommands()">
                                        <i class="fas fa-question-circle"></i> {{ t('ui.actions.help') }}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- System Reboot Section -->
                        <div class="form-section">
                            <h4><i class="fas fa-power-off"></i> {{ t('ui.system.reboot_title') }}</h4>
                            <small class="section-help">
                                {{ t('ui.system.reboot_help') }}
                            </small>
                            <div class="debug-action-card danger">
                                <div class="debug-action-info">
                                    <div class="debug-action-status">
                                        <span class="status-label">{{ t('ui.system.uptime_label') }}:</span>
                                        <span class="status-value" id="system-uptime">{{ t('ui.loading') }}</span>
                                    </div>
                                </div>
                                <div class="debug-action-buttons">
                                    <button type="button" class="btn btn-danger" onclick="confirmReboot()">
                                        <i class="fas fa-redo"></i> {{ t('ui.actions.restart') }}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    </div>
                </form>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>{{ t('ui.footer.text', version=app_version) }}</p>
        </footer>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Camera Profile Modal -->
    <div id="profile-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-clock"></i> <span id="profile-modal-title">{{ t('ui.video.new_profile') }}</span></h3>
                <button type="button" class="modal-close" onclick="closeProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="profile-form" onsubmit="saveProfile(event)">
                    <input type="hidden" id="profile-id" value="">
                    
                    <div class="form-group">
                        <label for="profile-name">
                            <i class="fas fa-tag"></i> {{ t('ui.profile.name_label') }}
                        </label>
                        <input type="text" id="profile-name" required placeholder="{{ t('ui.profile.name_placeholder') }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="profile-description">
                            <i class="fas fa-info-circle"></i> {{ t('ui.profile.description_label') }}
                        </label>
                        <input type="text" id="profile-description" placeholder="{{ t('ui.profile.description_placeholder') }}">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="profile-start">
                                <i class="fas fa-sun"></i> {{ t('ui.profile.start_time') }}
                            </label>
                            <input type="time" id="profile-start" value="07:00">
                        </div>
                        <div class="form-group">
                            <label for="profile-end">
                                <i class="fas fa-moon"></i> {{ t('ui.profile.end_time') }}
                            </label>
                            <input type="time" id="profile-end" value="19:00">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <i class="fas fa-power-off"></i> {{ t('ui.profile.active_label') }}
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="profile-enabled" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <i class="fas fa-camera"></i> {{ t('ui.profile.camera_settings') }}
                        </label>
                        <div class="profile-controls-info">
                            <span id="profile-controls-count">{{ t('ui.profile.settings_count', count=0) }}</span>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="captureCurrentSettings()">
                                <i class="fas fa-camera"></i> {{ t('ui.profile.capture_current') }}
                            </button>
                        </div>
                        <small>{{ t('ui.profile.capture_help') }}</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeProfileModal()">
                    <i class="fas fa-times"></i> {{ t('ui.actions.cancel') }}
                </button>
                <button type="button" class="btn btn-primary" onclick="saveProfile(event)">
                    <i class="fas fa-save"></i> {{ t('ui.actions.save') }}
                </button>
            </div>
        </div>
    </div>

    <div id="profile-settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cogs"></i> <span id="profile-settings-title">{{ t('ui.profile.settings_title') }}</span></h3>
                <button type="button" class="modal-close" onclick="closeProfileSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="profile-settings-meta" id="profile-settings-meta"></div>
                <div id="profile-settings-content"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeProfileSettingsModal()">{{ t('ui.actions.close') }}</button>
            </div>
        </div>
    </div>

    <div id="update-repo-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fab fa-github"></i> {{ t('ui.updates.update_from_repo') }}</h3>
                <button type="button" class="modal-close" onclick="closeUpdateRepoModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="status-row">
                    <span>{{ t('ui.updates.current_version') }}</span>
                    <span id="update-repo-current-version">-</span>
                </div>
                <div class="status-row">
                    <span>{{ t('ui.updates.available_version') }}</span>
                    <span id="update-repo-latest-version">-</span>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="update-repo-force" onchange="updateRepoApplyState()">
                        {{ t('ui.updates.force_reinstall') }}
                    </label>
                    <small>{{ t('ui.updates.force_reinstall_help') }}</small>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="update-repo-reset">
                        {{ t('ui.updates.reset_settings') }}
                    </label>
                    <small>{{ t('ui.updates.reset_settings_help') }}</small>
                </div>

                <div class="debug-action-status" id="update-repo-status">
                    <span class="status-label">{{ t('ui.status.label') }}:</span>
                    <span class="status-spinner" id="update-repo-status-spinner" style="display: none;">
                        <i class="fas fa-spinner fa-spin"></i>
                    </span>
                    <span class="status-value" id="update-repo-status-text">{{ t('ui.status.pending') }}</span>
                </div>

                <div class="update-log" id="update-repo-log" style="display: none;">
                    <pre></pre>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeUpdateRepoModal()">{{ t('ui.actions.close') }}</button>
                <button type="button" class="btn btn-primary" id="update-repo-apply-btn" onclick="applyUpdateRepo()" disabled>
                    <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                </button>
            </div>
        </div>
    </div>

    <div id="update-file-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-upload"></i> {{ t('ui.updates.update_from_file') }}</h3>
                <button type="button" class="modal-close" onclick="closeUpdateFileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="status-row">
                    <span>{{ t('ui.updates.file_label') }}</span>
                    <span id="update-file-name">-</span>
                </div>
                <div class="status-row">
                    <span>{{ t('ui.updates.current_version') }}</span>
                    <span id="update-current-version">-</span>
                </div>
                <div class="status-row">
                    <span>{{ t('ui.updates.update_version') }}</span>
                    <span id="update-new-version">-</span>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="update-file-force" onchange="onUpdateFileForceChanged()">
                        {{ t('ui.updates.force_reinstall') }}
                    </label>
                    <small>{{ t('ui.updates.force_reinstall_help') }}</small>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="update-file-reset">
                        {{ t('ui.updates.reset_settings') }}
                    </label>
                    <small>{{ t('ui.updates.reset_settings_help') }}</small>
                </div>
                <div class="form-group" id="update-file-deps-group" style="display: none;">
                    <label>{{ t('ui.updates.missing_deps') }}</label>
                    <small>{{ t('ui.updates.missing_deps_help') }}</small>
                    <small id="update-file-deps-info"></small>
                </div>

                <div class="debug-action-status" id="update-file-status">
                    <span class="status-label">{{ t('ui.status.label') }}:</span>
                    <span class="status-spinner" id="update-file-status-spinner" style="display: none;">
                        <i class="fas fa-spinner fa-spin"></i>
                    </span>
                    <span class="status-value" id="update-file-status-text">{{ t('ui.status.pending') }}</span>
                </div>

                <div class="update-log" id="update-file-log" style="display: none;">
                    <pre></pre>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeUpdateFileModal()">{{ t('ui.actions.close') }}</button>
                <button type="button" class="btn btn-primary" id="update-file-apply-btn" onclick="applyUpdateFile()" disabled>
                    <i class="fas fa-check"></i> {{ t('ui.actions.apply') }}
                </button>
            </div>
        </div>
    </div>

    <script>
        window.APP_VERSION = "{{ app_version }}";
        window.I18N_LANG = "{{ current_lang }}";
        window.I18N_TRANSLATIONS = {{ translations | tojson | safe }};
        window.I18N_FALLBACK = {{ default_translations | tojson | safe }};
    </script>
    <script src="{{ url_for('static', filename='js/modules/i18n.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/ui_utils.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/utils.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/navigation.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/home_status.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/logs.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/recordings.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/network.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/power.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/updates.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/meeting.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/camera.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/config_video.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/modules/diagnostics.js') }}?v={{ app_version }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}?v={{ app_version }}"></script>
</body>
</html>










